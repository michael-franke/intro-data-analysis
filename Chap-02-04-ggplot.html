<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.3 Basics of ggplot | An Introduction to Data Analysis</title>
  <meta name="description" content="Introductory text for statistics and data analysis (using R)" />
  <meta name="generator" content="bookdown 0.24.1 and GitBook 2.6.7" />

  <meta property="og:title" content="6.3 Basics of ggplot | An Introduction to Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Introductory text for statistics and data analysis (using R)" />
  <meta name="github-repo" content="michael-franke/intro-data-analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.3 Basics of ggplot | An Introduction to Data Analysis" />
  
  <meta name="twitter:description" content="Introductory text for statistics and data analysis (using R)" />
  

<meta name="author" content="Michael Franke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chap-02-04-good-visualization.html"/>
<link rel="next" href="Chap-02-04-geoms.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<!--<link rel="stylesheet" href="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-editor-1.0.9.css">-->
<link rel="stylesheet" href="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-viz-0.7.11.css">

<script src="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-editor-1.0.9.js"></script>
<script src="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-viz-0.7.11.js"></script>
<script src="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-v0.9.13.js" defer async></script>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />

<script type="application/javascript">
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.collapsibleSolution, .collapsibleProof').forEach(function(collapsible) {
    const content = collapsible.querySelector('.content')
    content.style.display = 'none';
    collapsible.querySelector('.trigger').addEventListener('click', function() {
      if (content.style.display === 'none') {
        content.style.display = 'block';
      } else {
        content.style.display = 'none';
      }
    })
  })
})
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />
<link rel="stylesheet" href="webppl-editor.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section"></a></li>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="general-introduction.html"><a href="general-introduction.html"><i class="fa fa-check"></i><b>1</b> General Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="Chap-01-00-intro-learning-goals.html"><a href="Chap-01-00-intro-learning-goals.html"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
<li class="chapter" data-level="1.2" data-path="Chap-01-00-intro-course-structure.html"><a href="Chap-01-00-intro-course-structure.html"><i class="fa fa-check"></i><b>1.2</b> Course structure</a></li>
<li class="chapter" data-level="1.3" data-path="Chap-01-00-intro-tools.html"><a href="Chap-01-00-intro-tools.html"><i class="fa fa-check"></i><b>1.3</b> Tools used in this course</a></li>
<li class="chapter" data-level="1.4" data-path="Chap-01-00-intro-topics.html"><a href="Chap-01-00-intro-topics.html"><i class="fa fa-check"></i><b>1.4</b> Topics covered (and not covered) in the course</a></li>
<li class="chapter" data-level="1.5" data-path="Chap-01-00-intro-data-sets.html"><a href="Chap-01-00-intro-data-sets.html"><i class="fa fa-check"></i><b>1.5</b> Data sets covered</a></li>
<li class="chapter" data-level="1.6" data-path="Chap-01-00-intro-installation.html"><a href="Chap-01-00-intro-installation.html"><i class="fa fa-check"></i><b>1.6</b> Installation</a></li>
<li class="chapter" data-level="1.7" data-path="Chap-01-00-intro-schedule.html"><a href="Chap-01-00-intro-schedule.html"><i class="fa fa-check"></i><b>1.7</b> Example schedule (12-week course)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chap-01-01-R.html"><a href="Chap-01-01-R.html"><i class="fa fa-check"></i><b>2</b> Basics of R</a><ul>
<li class="chapter" data-level="2.1" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html"><i class="fa fa-check"></i><b>2.1</b> First steps</a><ul>
<li class="chapter" data-level="2.1.1" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#functions"><i class="fa fa-check"></i><b>2.1.1</b> Functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#variables"><i class="fa fa-check"></i><b>2.1.2</b> Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#literate-coding"><i class="fa fa-check"></i><b>2.1.3</b> Literate coding</a></li>
<li class="chapter" data-level="2.1.4" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#objects"><i class="fa fa-check"></i><b>2.1.4</b> Objects</a></li>
<li class="chapter" data-level="2.1.5" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#packages"><i class="fa fa-check"></i><b>2.1.5</b> Packages</a></li>
<li class="chapter" data-level="2.1.6" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#Chap-01-01-R-help"><i class="fa fa-check"></i><b>2.1.6</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch1-data-types.html"><a href="ch1-data-types.html"><i class="fa fa-check"></i><b>2.2</b> Data types</a><ul>
<li class="chapter" data-level="2.2.1" data-path="ch1-data-types.html"><a href="ch1-data-types.html#numeric-vectors-matrices"><i class="fa fa-check"></i><b>2.2.1</b> Numeric vectors &amp; matrices</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch1-data-types.html"><a href="ch1-data-types.html#booleans"><i class="fa fa-check"></i><b>2.2.2</b> Booleans</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch1-data-types.html"><a href="ch1-data-types.html#special-values"><i class="fa fa-check"></i><b>2.2.3</b> Special values</a></li>
<li class="chapter" data-level="2.2.4" data-path="ch1-data-types.html"><a href="ch1-data-types.html#characters-strings"><i class="fa fa-check"></i><b>2.2.4</b> Characters (= strings)</a></li>
<li class="chapter" data-level="2.2.5" data-path="ch1-data-types.html"><a href="ch1-data-types.html#factors"><i class="fa fa-check"></i><b>2.2.5</b> Factors</a></li>
<li class="chapter" data-level="2.2.6" data-path="ch1-data-types.html"><a href="ch1-data-types.html#lists-data-frames-tibbles"><i class="fa fa-check"></i><b>2.2.6</b> Lists, data frames &amp; tibbles</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Chap-01-01-functions.html"><a href="Chap-01-01-functions.html"><i class="fa fa-check"></i><b>2.3</b> Functions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Chap-01-01-functions.html"><a href="Chap-01-01-functions.html#some-important-built-in-functions"><i class="fa fa-check"></i><b>2.3.1</b> Some important built-in functions</a></li>
<li class="chapter" data-level="2.3.2" data-path="Chap-01-01-functions.html"><a href="Chap-01-01-functions.html#defining-your-own-functions"><i class="fa fa-check"></i><b>2.3.2</b> Defining your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-01-01-loops-and-maps.html"><a href="ch-01-01-loops-and-maps.html"><i class="fa fa-check"></i><b>2.4</b> Loops and maps</a><ul>
<li class="chapter" data-level="2.4.1" data-path="ch-01-01-loops-and-maps.html"><a href="ch-01-01-loops-and-maps.html#for-loops"><i class="fa fa-check"></i><b>2.4.1</b> For-loops</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-01-01-loops-and-maps.html"><a href="ch-01-01-loops-and-maps.html#functional-iterators"><i class="fa fa-check"></i><b>2.4.2</b> Functional iterators</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Chap-01-01-piping.html"><a href="Chap-01-01-piping.html"><i class="fa fa-check"></i><b>2.5</b> Piping</a><ul>
<li class="chapter" data-level="2.5.1" data-path="Chap-01-01-piping.html"><a href="Chap-01-01-piping.html#excursion-more-on-pipes-in-r"><i class="fa fa-check"></i><b>2.5.1</b> Excursion: More on pipes in R</a></li>
<li class="chapter" data-level="2.5.2" data-path="Chap-01-01-piping.html"><a href="Chap-01-01-piping.html#excursion-multiple-assignments-or-unpacking"><i class="fa fa-check"></i><b>2.5.2</b> Excursion: Multiple assignments, or “unpacking”</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-01-01-Rmarkdown.html"><a href="ch-01-01-Rmarkdown.html"><i class="fa fa-check"></i><b>2.6</b> Rmarkdown</a></li>
</ul></li>
<li class="part"><span><b>II Data</b></span></li>
<li class="chapter" data-level="3" data-path="Chap-02-01-data.html"><a href="Chap-02-01-data.html"><i class="fa fa-check"></i><b>3</b> Data, variables &amp; experimental designs</a><ul>
<li class="chapter" data-level="3.1" data-path="Chap-02-01-data-what-is-data.html"><a href="Chap-02-01-data-what-is-data.html"><i class="fa fa-check"></i><b>3.1</b> What is data?</a></li>
<li class="chapter" data-level="3.2" data-path="Chap-02-01-data-kinds-of-data.html"><a href="Chap-02-01-data-kinds-of-data.html"><i class="fa fa-check"></i><b>3.2</b> Different kinds of data</a></li>
<li class="chapter" data-level="3.3" data-path="Chap-02-01-data-variables.html"><a href="Chap-02-01-data-variables.html"><i class="fa fa-check"></i><b>3.3</b> On the notion of “variables”</a></li>
<li class="chapter" data-level="3.4" data-path="Chap-02-01-data-exp-design.html"><a href="Chap-02-01-data-exp-design.html"><i class="fa fa-check"></i><b>3.4</b> Basics of experimental design</a><ul>
<li class="chapter" data-level="3.4.1" data-path="Chap-02-01-data-exp-design.html"><a href="Chap-02-01-data-exp-design.html#what-to-analyze-dependent-variables"><i class="fa fa-check"></i><b>3.4.1</b> What to analyze? – Dependent variables</a></li>
<li class="chapter" data-level="3.4.2" data-path="Chap-02-01-data-exp-design.html"><a href="Chap-02-01-data-exp-design.html#conditions-trials-items"><i class="fa fa-check"></i><b>3.4.2</b> Conditions, trials, items</a></li>
<li class="chapter" data-level="3.4.3" data-path="Chap-02-01-data-exp-design.html"><a href="Chap-02-01-data-exp-design.html#sample-size"><i class="fa fa-check"></i><b>3.4.3</b> Sample size</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling</a><ul>
<li class="chapter" data-level="4.1" data-path="Chap-02-02-data-IO.html"><a href="Chap-02-02-data-IO.html"><i class="fa fa-check"></i><b>4.1</b> Data in, data out</a></li>
<li class="chapter" data-level="4.2" data-path="Chap-02-02-data-tidy-data.html"><a href="Chap-02-02-data-tidy-data.html"><i class="fa fa-check"></i><b>4.2</b> Tidy data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="Chap-02-02-data-tidy-data.html"><a href="Chap-02-02-data-tidy-data.html#running-example"><i class="fa fa-check"></i><b>4.2.1</b> Running example</a></li>
<li class="chapter" data-level="4.2.2" data-path="Chap-02-02-data-tidy-data.html"><a href="Chap-02-02-data-tidy-data.html#definition-of-tidy-data"><i class="fa fa-check"></i><b>4.2.2</b> Definition of <em>tidy data</em></a></li>
<li class="chapter" data-level="4.2.3" data-path="Chap-02-02-data-tidy-data.html"><a href="Chap-02-02-data-tidy-data.html#excursion-non-redundant-data"><i class="fa fa-check"></i><b>4.2.3</b> Excursion: non-redundant data</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html"><i class="fa fa-check"></i><b>4.3</b> Data manipulation: the basics</a><ul>
<li class="chapter" data-level="4.3.1" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#pivoting"><i class="fa fa-check"></i><b>4.3.1</b> Pivoting</a></li>
<li class="chapter" data-level="4.3.2" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#subsetting-rows-columns"><i class="fa fa-check"></i><b>4.3.2</b> Subsetting rows &amp; columns</a></li>
<li class="chapter" data-level="4.3.3" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#Chap-02-02-tidy-selection"><i class="fa fa-check"></i><b>4.3.3</b> Tidy selection of column names</a></li>
<li class="chapter" data-level="4.3.4" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#adding-changing-and-renaming-columns"><i class="fa fa-check"></i><b>4.3.4</b> Adding, changing and renaming columns</a></li>
<li class="chapter" data-level="4.3.5" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#splitting-and-uniting-columns"><i class="fa fa-check"></i><b>4.3.5</b> Splitting and uniting columns</a></li>
<li class="chapter" data-level="4.3.6" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#sorting-a-data-set"><i class="fa fa-check"></i><b>4.3.6</b> Sorting a data set</a></li>
<li class="chapter" data-level="4.3.7" data-path="Chap-02-02-data-preprocessing-cleaning.html"><a href="Chap-02-02-data-preprocessing-cleaning.html#combining-tibbles"><i class="fa fa-check"></i><b>4.3.7</b> Combining tibbles</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Chap-02-02-data-grouping-nesting.html"><a href="Chap-02-02-data-grouping-nesting.html"><i class="fa fa-check"></i><b>4.4</b> Grouped operations</a></li>
<li class="chapter" data-level="4.5" data-path="Chap-02-02-data-case-study-KoF.html"><a href="Chap-02-02-data-case-study-KoF.html"><i class="fa fa-check"></i><b>4.5</b> Case study: the King of France</a><ul>
<li class="chapter" data-level="4.5.1" data-path="Chap-02-02-data-case-study-KoF.html"><a href="Chap-02-02-data-case-study-KoF.html#cleaning-the-data"><i class="fa fa-check"></i><b>4.5.1</b> Cleaning the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chap-02-03-summary-statistics.html"><a href="Chap-02-03-summary-statistics.html"><i class="fa fa-check"></i><b>5</b> Summary statistics</a><ul>
<li class="chapter" data-level="5.1" data-path="Chap-02-03-summary-statistics-counts.html"><a href="Chap-02-03-summary-statistics-counts.html"><i class="fa fa-check"></i><b>5.1</b> Counts and proportions</a><ul>
<li class="chapter" data-level="5.1.1" data-path="Chap-02-03-summary-statistics-counts.html"><a href="Chap-02-03-summary-statistics-counts.html#loading-and-inspecting-the-data"><i class="fa fa-check"></i><b>5.1.1</b> Loading and inspecting the data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Chap-02-03-summary-statistics-counts.html"><a href="Chap-02-03-summary-statistics-counts.html#obtaining-counts-with-n-count-and-tally"><i class="fa fa-check"></i><b>5.1.2</b> Obtaining counts with <code>n</code>, <code>count</code> and <code>tally</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Chap-02-03-summary-statistics-1D.html"><a href="Chap-02-03-summary-statistics-1D.html"><i class="fa fa-check"></i><b>5.2</b> Central tendency and dispersion</a><ul>
<li class="chapter" data-level="5.2.1" data-path="Chap-02-03-summary-statistics-1D.html"><a href="Chap-02-03-summary-statistics-1D.html#the-data-for-the-remainder-of-the-chapter"><i class="fa fa-check"></i><b>5.2.1</b> The data for the remainder of the chapter</a></li>
<li class="chapter" data-level="5.2.2" data-path="Chap-02-03-summary-statistics-1D.html"><a href="Chap-02-03-summary-statistics-1D.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>5.2.2</b> Measures of central tendency</a></li>
<li class="chapter" data-level="5.2.3" data-path="Chap-02-03-summary-statistics-1D.html"><a href="Chap-02-03-summary-statistics-1D.html#measures-of-dispersion"><i class="fa fa-check"></i><b>5.2.3</b> Measures of dispersion</a></li>
<li class="chapter" data-level="5.2.4" data-path="Chap-02-03-summary-statistics-1D.html"><a href="Chap-02-03-summary-statistics-1D.html#excursion-quantifying-confidence-with-bootstrapping"><i class="fa fa-check"></i><b>5.2.4</b> Excursion: Quantifying confidence with bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Chap-02-03-summary-statistics-2D.html"><a href="Chap-02-03-summary-statistics-2D.html"><i class="fa fa-check"></i><b>5.3</b> Covariance and correlation</a><ul>
<li class="chapter" data-level="5.3.1" data-path="Chap-02-03-summary-statistics-2D.html"><a href="Chap-02-03-summary-statistics-2D.html#covariance"><i class="fa fa-check"></i><b>5.3.1</b> Covariance</a></li>
<li class="chapter" data-level="5.3.2" data-path="Chap-02-03-summary-statistics-2D.html"><a href="Chap-02-03-summary-statistics-2D.html#correlation"><i class="fa fa-check"></i><b>5.3.2</b> Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Chap-02-02-visualization.html"><a href="Chap-02-02-visualization.html"><i class="fa fa-check"></i><b>6</b> Data Visualization</a><ul>
<li class="chapter" data-level="6.1" data-path="Chap-02-04-Anscombe-example.html"><a href="Chap-02-04-Anscombe-example.html"><i class="fa fa-check"></i><b>6.1</b> Motivating example: Anscombe’s quartet</a></li>
<li class="chapter" data-level="6.2" data-path="Chap-02-04-good-visualization.html"><a href="Chap-02-04-good-visualization.html"><i class="fa fa-check"></i><b>6.2</b> Visualization: the good, the bad and the infographic</a></li>
<li class="chapter" data-level="6.3" data-path="Chap-02-04-ggplot.html"><a href="Chap-02-04-ggplot.html"><i class="fa fa-check"></i><b>6.3</b> Basics of <code>ggplot</code></a><ul>
<li class="chapter" data-level="6.3.1" data-path="Chap-02-04-ggplot.html"><a href="Chap-02-04-ggplot.html#incremental-composition-of-a-plot"><i class="fa fa-check"></i><b>6.3.1</b> Incremental composition of a plot</a></li>
<li class="chapter" data-level="6.3.2" data-path="Chap-02-04-ggplot.html"><a href="Chap-02-04-ggplot.html#elements-in-the-layered-grammar-of-graphs"><i class="fa fa-check"></i><b>6.3.2</b> Elements in the layered grammar of graphs</a></li>
<li class="chapter" data-level="6.3.3" data-path="Chap-02-04-ggplot.html"><a href="Chap-02-04-ggplot.html#layers-and-groups"><i class="fa fa-check"></i><b>6.3.3</b> Layers and groups</a></li>
<li class="chapter" data-level="6.3.4" data-path="Chap-02-04-ggplot.html"><a href="Chap-02-04-ggplot.html#grouping"><i class="fa fa-check"></i><b>6.3.4</b> Grouping</a></li>
<li class="chapter" data-level="6.3.5" data-path="Chap-02-04-ggplot.html"><a href="Chap-02-04-ggplot.html#example-of-a-customized-plot"><i class="fa fa-check"></i><b>6.3.5</b> Example of a customized plot</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html"><i class="fa fa-check"></i><b>6.4</b> A rendezvous with popular geoms</a><ul>
<li class="chapter" data-level="6.4.1" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#scatter-plots-with-geom_point"><i class="fa fa-check"></i><b>6.4.1</b> Scatter plots with <code>geom_point</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#smooth"><i class="fa fa-check"></i><b>6.4.2</b> Smooth</a></li>
<li class="chapter" data-level="6.4.3" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#line"><i class="fa fa-check"></i><b>6.4.3</b> Line</a></li>
<li class="chapter" data-level="6.4.4" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#bar-plot"><i class="fa fa-check"></i><b>6.4.4</b> Bar plot</a></li>
<li class="chapter" data-level="6.4.5" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#plotting-distributions-histograms-boxplots-densities-and-violins"><i class="fa fa-check"></i><b>6.4.5</b> Plotting distributions: histograms, boxplots, densities and violins</a></li>
<li class="chapter" data-level="6.4.6" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#rugs"><i class="fa fa-check"></i><b>6.4.6</b> Rugs</a></li>
<li class="chapter" data-level="6.4.7" data-path="Chap-02-04-geoms.html"><a href="Chap-02-04-geoms.html#annotation"><i class="fa fa-check"></i><b>6.4.7</b> Annotation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="Chap-02-04-faceting.html"><a href="Chap-02-04-faceting.html"><i class="fa fa-check"></i><b>6.5</b> Faceting</a></li>
<li class="chapter" data-level="6.6" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html"><i class="fa fa-check"></i><b>6.6</b> Customization etc.</a><ul>
<li class="chapter" data-level="6.6.1" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html#themes"><i class="fa fa-check"></i><b>6.6.1</b> Themes</a></li>
<li class="chapter" data-level="6.6.2" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html#guides"><i class="fa fa-check"></i><b>6.6.2</b> Guides</a></li>
<li class="chapter" data-level="6.6.3" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html#axes-ticks-and-tick-labels"><i class="fa fa-check"></i><b>6.6.3</b> Axes, ticks and tick labels</a></li>
<li class="chapter" data-level="6.6.4" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html#labels"><i class="fa fa-check"></i><b>6.6.4</b> Labels</a></li>
<li class="chapter" data-level="6.6.5" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html#combining-arranging-plots"><i class="fa fa-check"></i><b>6.6.5</b> Combining &amp; arranging plots</a></li>
<li class="chapter" data-level="6.6.6" data-path="Chap-02-04-customization.html"><a href="Chap-02-04-customization.html#latex-expressions-in-plot-labels"><i class="fa fa-check"></i><b>6.6.6</b> LaTeX expressions in plot labels</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Bayesian Data Analysis</b></span></li>
<li class="chapter" data-level="7" data-path="Chap-03-01-probability.html"><a href="Chap-03-01-probability.html"><i class="fa fa-check"></i><b>7</b> Basics of Probability Theory</a><ul>
<li class="chapter" data-level="7.1" data-path="Chap-03-01-probability-basics.html"><a href="Chap-03-01-probability-basics.html"><i class="fa fa-check"></i><b>7.1</b> Probability</a><ul>
<li class="chapter" data-level="7.1.1" data-path="Chap-03-01-probability-basics.html"><a href="Chap-03-01-probability-basics.html#outcomes-events-observations"><i class="fa fa-check"></i><b>7.1.1</b> Outcomes, events, observations</a></li>
<li class="chapter" data-level="7.1.2" data-path="Chap-03-01-probability-basics.html"><a href="Chap-03-01-probability-basics.html#probability-distributions"><i class="fa fa-check"></i><b>7.1.2</b> Probability distributions</a></li>
<li class="chapter" data-level="7.1.3" data-path="Chap-03-01-probability-basics.html"><a href="Chap-03-01-probability-basics.html#interpretations-of-probability"><i class="fa fa-check"></i><b>7.1.3</b> Interpretations of probability</a></li>
<li class="chapter" data-level="7.1.4" data-path="Chap-03-01-probability-basics.html"><a href="Chap-03-01-probability-basics.html#distributions-as-samples"><i class="fa fa-check"></i><b>7.1.4</b> Distributions as samples</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="Chap-03-01-probability-marginal.html"><a href="Chap-03-01-probability-marginal.html"><i class="fa fa-check"></i><b>7.2</b> Structured events &amp; marginal distributions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="Chap-03-01-probability-marginal.html"><a href="Chap-03-01-probability-marginal.html#probability-table-for-a-flip-and-draw-scenario"><i class="fa fa-check"></i><b>7.2.1</b> Probability table for a flip-and-draw scenario</a></li>
<li class="chapter" data-level="7.2.2" data-path="Chap-03-01-probability-marginal.html"><a href="Chap-03-01-probability-marginal.html#structured-events-and-joint-probability-distributions"><i class="fa fa-check"></i><b>7.2.2</b> Structured events and joint-probability distributions</a></li>
<li class="chapter" data-level="7.2.3" data-path="Chap-03-01-probability-marginal.html"><a href="Chap-03-01-probability-marginal.html#marginalization"><i class="fa fa-check"></i><b>7.2.3</b> Marginalization</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Chap-03-01-probability-conditional.html"><a href="Chap-03-01-probability-conditional.html"><i class="fa fa-check"></i><b>7.3</b> Conditional probability</a><ul>
<li class="chapter" data-level="7.3.1" data-path="Chap-03-01-probability-conditional.html"><a href="Chap-03-01-probability-conditional.html#bayes-rule"><i class="fa fa-check"></i><b>7.3.1</b> Bayes rule</a></li>
<li class="chapter" data-level="7.3.2" data-path="Chap-03-01-probability-conditional.html"><a href="Chap-03-01-probability-conditional.html#Chap-03-01-probability-independence"><i class="fa fa-check"></i><b>7.3.2</b> Stochastic (in-)dependence</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Chap-03-01-probability-random-variables.html"><a href="Chap-03-01-probability-random-variables.html"><i class="fa fa-check"></i><b>7.4</b> Random variables</a><ul>
<li class="chapter" data-level="7.4.1" data-path="Chap-03-01-probability-random-variables.html"><a href="Chap-03-01-probability-random-variables.html#notation-terminology"><i class="fa fa-check"></i><b>7.4.1</b> Notation &amp; terminology</a></li>
<li class="chapter" data-level="7.4.2" data-path="Chap-03-01-probability-random-variables.html"><a href="Chap-03-01-probability-random-variables.html#cumulative-distribution-functions-mass-density"><i class="fa fa-check"></i><b>7.4.2</b> Cumulative distribution functions, mass &amp; density</a></li>
<li class="chapter" data-level="7.4.3" data-path="Chap-03-01-probability-random-variables.html"><a href="Chap-03-01-probability-random-variables.html#expected-value-variance"><i class="fa fa-check"></i><b>7.4.3</b> Expected value &amp; variance</a></li>
<li class="chapter" data-level="7.4.4" data-path="Chap-03-01-probability-random-variables.html"><a href="Chap-03-01-probability-random-variables.html#composite-random-variables"><i class="fa fa-check"></i><b>7.4.4</b> Composite random variables</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Chap-03-01-probability-R.html"><a href="Chap-03-01-probability-R.html"><i class="fa fa-check"></i><b>7.5</b> Probability distributions in R</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Chap-03-03-models.html"><a href="Chap-03-03-models.html"><i class="fa fa-check"></i><b>8</b> Statistical models</a><ul>
<li class="chapter" data-level="8.1" data-path="Chap-03-03-models-general.html"><a href="Chap-03-03-models-general.html"><i class="fa fa-check"></i><b>8.1</b> Statistical models</a></li>
<li class="chapter" data-level="8.2" data-path="Chap-03-03-models-representation.html"><a href="Chap-03-03-models-representation.html"><i class="fa fa-check"></i><b>8.2</b> Notation &amp; graphical representation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="Chap-03-03-models-representation.html"><a href="Chap-03-03-models-representation.html#formula-notation"><i class="fa fa-check"></i><b>8.2.1</b> Formula notation</a></li>
<li class="chapter" data-level="8.2.2" data-path="Chap-03-03-models-representation.html"><a href="Chap-03-03-models-representation.html#graphical-notation"><i class="fa fa-check"></i><b>8.2.2</b> Graphical notation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="Chap-03-03-models-parameters-priors.html"><a href="Chap-03-03-models-parameters-priors.html"><i class="fa fa-check"></i><b>8.3</b> Parameters, priors, and prior predictions</a><ul>
<li class="chapter" data-level="8.3.1" data-path="Chap-03-03-models-parameters-priors.html"><a href="Chap-03-03-models-parameters-priors.html#whats-a-model-parameter"><i class="fa fa-check"></i><b>8.3.1</b> What’s a model parameter?</a></li>
<li class="chapter" data-level="8.3.2" data-path="Chap-03-03-models-parameters-priors.html"><a href="Chap-03-03-models-parameters-priors.html#Chap-03-02-models-priors"><i class="fa fa-check"></i><b>8.3.2</b> Priors over parameters</a></li>
<li class="chapter" data-level="8.3.3" data-path="Chap-03-03-models-parameters-priors.html"><a href="Chap-03-03-models-parameters-priors.html#Chap-03-03-models-parameters-prior-predictive"><i class="fa fa-check"></i><b>8.3.3</b> Prior predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-03-04-parameter-estimation.html"><a href="ch-03-04-parameter-estimation.html"><i class="fa fa-check"></i><b>9</b> Bayesian parameter estimation</a><ul>
<li class="chapter" data-level="9.1" data-path="ch-03-03-estimation-bayes.html"><a href="ch-03-03-estimation-bayes.html"><i class="fa fa-check"></i><b>9.1</b> Bayes rule for parameter estimation</a><ul>
<li class="chapter" data-level="9.1.1" data-path="ch-03-03-estimation-bayes.html"><a href="ch-03-03-estimation-bayes.html#definitions-and-terminology"><i class="fa fa-check"></i><b>9.1.1</b> Definitions and terminology</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-03-03-estimation-bayes.html"><a href="ch-03-03-estimation-bayes.html#the-effects-of-prior-and-likelihood-on-the-posterior"><i class="fa fa-check"></i><b>9.1.2</b> The effects of prior and likelihood on the posterior</a></li>
<li class="chapter" data-level="9.1.3" data-path="ch-03-03-estimation-bayes.html"><a href="ch-03-03-estimation-bayes.html#ch-03-04-parameter-estimation-conjugacy"><i class="fa fa-check"></i><b>9.1.3</b> Computing Bayesian posteriors with conjugate priors</a></li>
<li class="chapter" data-level="9.1.4" data-path="ch-03-03-estimation-bayes.html"><a href="ch-03-03-estimation-bayes.html#excursion-sequential-updating"><i class="fa fa-check"></i><b>9.1.4</b> Excursion: Sequential updating</a></li>
<li class="chapter" data-level="9.1.5" data-path="ch-03-03-estimation-bayes.html"><a href="ch-03-03-estimation-bayes.html#posterior-predictive-distribution"><i class="fa fa-check"></i><b>9.1.5</b> Posterior predictive distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-03-04-parameter-estimation-points-intervals.html"><a href="ch-03-04-parameter-estimation-points-intervals.html"><i class="fa fa-check"></i><b>9.2</b> Point-valued and interval-ranged estimates</a><ul>
<li class="chapter" data-level="9.2.1" data-path="ch-03-04-parameter-estimation-points-intervals.html"><a href="ch-03-04-parameter-estimation-points-intervals.html#point-valued-estimates"><i class="fa fa-check"></i><b>9.2.1</b> Point-valued estimates</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch-03-04-parameter-estimation-points-intervals.html"><a href="ch-03-04-parameter-estimation-points-intervals.html#interval-ranged-estimates"><i class="fa fa-check"></i><b>9.2.2</b> Interval-ranged estimates</a></li>
<li class="chapter" data-level="9.2.3" data-path="ch-03-04-parameter-estimation-points-intervals.html"><a href="ch-03-04-parameter-estimation-points-intervals.html#computing-bayesian-estimates"><i class="fa fa-check"></i><b>9.2.3</b> Computing Bayesian estimates</a></li>
<li class="chapter" data-level="9.2.4" data-path="ch-03-04-parameter-estimation-points-intervals.html"><a href="ch-03-04-parameter-estimation-points-intervals.html#excursion-computing-mles-and-maps-in-r"><i class="fa fa-check"></i><b>9.2.4</b> Excursion: Computing MLEs and MAPs in R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="Ch-03-03-estimation-algorithms.html"><a href="Ch-03-03-estimation-algorithms.html"><i class="fa fa-check"></i><b>9.3</b> Approximating the posterior</a><ul>
<li class="chapter" data-level="9.3.1" data-path="Ch-03-03-estimation-algorithms.html"><a href="Ch-03-03-estimation-algorithms.html#ch-03-03-MCMC"><i class="fa fa-check"></i><b>9.3.1</b> Of apples and trees: Markov Chain Monte Carlo sampling</a></li>
<li class="chapter" data-level="9.3.2" data-path="Ch-03-03-estimation-algorithms.html"><a href="Ch-03-03-estimation-algorithms.html#ch-03-03-estimation-Stan"><i class="fa fa-check"></i><b>9.3.2</b> Excursion: Probabilistic modeling with Stan</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ch-03-04-parameter-estimation-normal.html"><a href="ch-03-04-parameter-estimation-normal.html"><i class="fa fa-check"></i><b>9.4</b> Estimating the parameters of a Normal distribution</a><ul>
<li class="chapter" data-level="9.4.1" data-path="ch-03-04-parameter-estimation-normal.html"><a href="ch-03-04-parameter-estimation-normal.html#uninformative-priors"><i class="fa fa-check"></i><b>9.4.1</b> Uninformative priors</a></li>
<li class="chapter" data-level="9.4.2" data-path="ch-03-04-parameter-estimation-normal.html"><a href="ch-03-04-parameter-estimation-normal.html#conjugate-priors"><i class="fa fa-check"></i><b>9.4.2</b> Conjugate priors</a></li>
<li class="chapter" data-level="9.4.3" data-path="ch-03-04-parameter-estimation-normal.html"><a href="ch-03-04-parameter-estimation-normal.html#estimating-the-difference-between-group-means"><i class="fa fa-check"></i><b>9.4.3</b> Estimating the difference between group means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Chap-03-06-model-comparison.html"><a href="Chap-03-06-model-comparison.html"><i class="fa fa-check"></i><b>10</b> Model Comparison</a><ul>
<li class="chapter" data-level="10.1" data-path="Chap-03-06-model-comparison-case-study.html"><a href="Chap-03-06-model-comparison-case-study.html"><i class="fa fa-check"></i><b>10.1</b> Case study: recall models</a></li>
<li class="chapter" data-level="10.2" data-path="Chap-03-06-model-comparison-AIC.html"><a href="Chap-03-06-model-comparison-AIC.html"><i class="fa fa-check"></i><b>10.2</b> Akaike Information Criterion</a></li>
<li class="chapter" data-level="10.3" data-path="Chap-03-06-model-comparison-BF.html"><a href="Chap-03-06-model-comparison-BF.html"><i class="fa fa-check"></i><b>10.3</b> Bayes factors</a><ul>
<li class="chapter" data-level="10.3.1" data-path="Chap-03-06-model-comparison-BF.html"><a href="Chap-03-06-model-comparison-BF.html#Chap-03-06-model-comparison-BF-grid"><i class="fa fa-check"></i><b>10.3.1</b> Grid approximation</a></li>
<li class="chapter" data-level="10.3.2" data-path="Chap-03-06-model-comparison-BF.html"><a href="Chap-03-06-model-comparison-BF.html#Chap-03-06-model-comparison-BF-naiveMC"><i class="fa fa-check"></i><b>10.3.2</b> Naive Monte Carlo</a></li>
<li class="chapter" data-level="10.3.3" data-path="Chap-03-06-model-comparison-BF.html"><a href="Chap-03-06-model-comparison-BF.html#Chap-03-06-model-comparison-BF-bridge"><i class="fa fa-check"></i><b>10.3.3</b> Excursion: Bridge sampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-03-07-hypothesis-testing-Bayes.html"><a href="ch-03-07-hypothesis-testing-Bayes.html"><i class="fa fa-check"></i><b>11</b> Bayesian hypothesis testing</a><ul>
<li class="chapter" data-level="11.1" data-path="ch-03-07-hypothesis-testing-Bayes-hypotheses.html"><a href="ch-03-07-hypothesis-testing-Bayes-hypotheses.html"><i class="fa fa-check"></i><b>11.1</b> Statistical hypotheses</a></li>
<li class="chapter" data-level="11.2" data-path="data-and-models-for-this-chapter.html"><a href="data-and-models-for-this-chapter.html"><i class="fa fa-check"></i><b>11.2</b> Data and models for this chapter</a><ul>
<li class="chapter" data-level="11.2.1" data-path="data-and-models-for-this-chapter.html"><a href="data-and-models-for-this-chapter.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> 24/7</a></li>
<li class="chapter" data-level="11.2.2" data-path="data-and-models-for-this-chapter.html"><a href="data-and-models-for-this-chapter.html#simon-task"><i class="fa fa-check"></i><b>11.2.2</b> Simon task</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ch-03-05-Bayes-testing-estimation.html"><a href="ch-03-05-Bayes-testing-estimation.html"><i class="fa fa-check"></i><b>11.3</b> Testing via posterior estimation</a><ul>
<li class="chapter" data-level="11.3.1" data-path="ch-03-05-Bayes-testing-estimation.html"><a href="ch-03-05-Bayes-testing-estimation.html#example-247"><i class="fa fa-check"></i><b>11.3.1</b> Example: 24/7</a></li>
<li class="chapter" data-level="11.3.2" data-path="ch-03-05-Bayes-testing-estimation.html"><a href="ch-03-05-Bayes-testing-estimation.html#example-simon-task"><i class="fa fa-check"></i><b>11.3.2</b> Example: Simon Task</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ch-03-05-Bayesian-testing-comparison.html"><a href="ch-03-05-Bayesian-testing-comparison.html"><i class="fa fa-check"></i><b>11.4</b> Testing via model comparison</a><ul>
<li class="chapter" data-level="11.4.1" data-path="ch-03-05-Bayesian-testing-comparison.html"><a href="ch-03-05-Bayesian-testing-comparison.html#ch-03-07-hypothesis-testing-Bayes-Savage-Dickey"><i class="fa fa-check"></i><b>11.4.1</b> The Savage-Dickey method</a></li>
<li class="chapter" data-level="11.4.2" data-path="ch-03-05-Bayesian-testing-comparison.html"><a href="ch-03-05-Bayesian-testing-comparison.html#ch-03-07-hypothesis-testing-Bayes-encompassing-models"><i class="fa fa-check"></i><b>11.4.2</b> Encompassing models</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Applied (generalized) linear modeling</b></span></li>
<li class="chapter" data-level="12" data-path="Chap-04-01-simple-linear-regression.html"><a href="Chap-04-01-simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Linear regression</a><ul>
<li class="chapter" data-level="12.1" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html"><i class="fa fa-check"></i><b>12.1</b> Ordinary least squares regression</a><ul>
<li class="chapter" data-level="12.1.1" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#prediction-without-any-further-information"><i class="fa fa-check"></i><b>12.1.1</b> Prediction without any further information</a></li>
<li class="chapter" data-level="12.1.2" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#prediction-with-knowledge-of-unemployment-rate"><i class="fa fa-check"></i><b>12.1.2</b> Prediction with knowledge of unemployment rate</a></li>
<li class="chapter" data-level="12.1.3" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#linear-regression-general-problem-formulation"><i class="fa fa-check"></i><b>12.1.3</b> Linear regression: general problem formulation</a></li>
<li class="chapter" data-level="12.1.4" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#finding-the-ols-solution"><i class="fa fa-check"></i><b>12.1.4</b> Finding the OLS-solution</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="Chap-04-01-linear-regression-MLE.html"><a href="Chap-04-01-linear-regression-MLE.html"><i class="fa fa-check"></i><b>12.2</b> A maximum-likelihood approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="Chap-04-01-linear-regression-MLE.html"><a href="Chap-04-01-linear-regression-MLE.html#a-likelihood-based-model"><i class="fa fa-check"></i><b>12.2.1</b> A likelihood-based model</a></li>
<li class="chapter" data-level="12.2.2" data-path="Chap-04-01-linear-regression-MLE.html"><a href="Chap-04-01-linear-regression-MLE.html#finding-the-mle-solution-with-optim"><i class="fa fa-check"></i><b>12.2.2</b> Finding the MLE-solution with <code>optim</code></a></li>
<li class="chapter" data-level="12.2.3" data-path="Chap-04-01-linear-regression-MLE.html"><a href="Chap-04-01-linear-regression-MLE.html#finding-the-mle-solution-with-glm"><i class="fa fa-check"></i><b>12.2.3</b> Finding the MLE-solution with <code>glm</code></a></li>
<li class="chapter" data-level="12.2.4" data-path="Chap-04-01-linear-regression-MLE.html"><a href="Chap-04-01-linear-regression-MLE.html#finding-the-mle-solution-with-math"><i class="fa fa-check"></i><b>12.2.4</b> Finding the MLE-solution with math</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="a-bayesian-approach.html"><a href="a-bayesian-approach.html"><i class="fa fa-check"></i><b>12.3</b> A Bayesian approach</a></li>
<li class="chapter" data-level="12.4" data-path="comparison-of-approaches.html"><a href="comparison-of-approaches.html"><i class="fa fa-check"></i><b>12.4</b> Comparison of approaches</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Chap-04-02-Bayes-regression-practice.html"><a href="Chap-04-02-Bayes-regression-practice.html"><i class="fa fa-check"></i><b>13</b> Bayesian regression in practice</a><ul>
<li class="chapter" data-level="13.1" data-path="simple-linear-regression-with-brms.html"><a href="simple-linear-regression-with-brms.html"><i class="fa fa-check"></i><b>13.1</b> Simple linear regression with <code>brms</code></a></li>
<li class="chapter" data-level="13.2" data-path="extracting-posterior-samples.html"><a href="extracting-posterior-samples.html"><i class="fa fa-check"></i><b>13.2</b> Extracting posterior samples</a></li>
<li class="chapter" data-level="13.3" data-path="excursion-inspecting-the-underlying-stan-code.html"><a href="excursion-inspecting-the-underlying-stan-code.html"><i class="fa fa-check"></i><b>13.3</b> [Excursion:] Inspecting the underlying Stan code</a></li>
<li class="chapter" data-level="13.4" data-path="setting-priors.html"><a href="setting-priors.html"><i class="fa fa-check"></i><b>13.4</b> Setting priors</a></li>
<li class="chapter" data-level="13.5" data-path="posterior-predictions.html"><a href="posterior-predictions.html"><i class="fa fa-check"></i><b>13.5</b> Posterior predictions</a></li>
<li class="chapter" data-level="13.6" data-path="testing-hypotheses.html"><a href="testing-hypotheses.html"><i class="fa fa-check"></i><b>13.6</b> Testing hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="Chap-04-03-predictors.html"><a href="Chap-04-03-predictors.html"><i class="fa fa-check"></i><b>14</b> Categorical predictors</a><ul>
<li class="chapter" data-level="14.1" data-path="Chap-04-03-predictors-two-levels.html"><a href="Chap-04-03-predictors-two-levels.html"><i class="fa fa-check"></i><b>14.1</b> Single two-level predictor</a></li>
<li class="chapter" data-level="14.2" data-path="Chap-04-03-predictors-multi-levels.html"><a href="Chap-04-03-predictors-multi-levels.html"><i class="fa fa-check"></i><b>14.2</b> Single multi-level predictor</a></li>
<li class="chapter" data-level="14.3" data-path="Chap-04-03-predictors-multiple-predictors.html"><a href="Chap-04-03-predictors-multiple-predictors.html"><i class="fa fa-check"></i><b>14.3</b> Multiple predictors</a><ul>
<li class="chapter" data-level="14.3.1" data-path="Chap-04-03-predictors-multiple-predictors.html"><a href="Chap-04-03-predictors-multiple-predictors.html#treatment-coding"><i class="fa fa-check"></i><b>14.3.1</b> Treatment coding</a></li>
<li class="chapter" data-level="14.3.2" data-path="Chap-04-03-predictors-multiple-predictors.html"><a href="Chap-04-03-predictors-multiple-predictors.html#sum-coding"><i class="fa fa-check"></i><b>14.3.2</b> Sum coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="Chap-04-04-GLM.html"><a href="Chap-04-04-GLM.html"><i class="fa fa-check"></i><b>15</b> Generalized linear model</a><ul>
<li class="chapter" data-level="15.1" data-path="generalizing-the-linear-regression-model.html"><a href="generalizing-the-linear-regression-model.html"><i class="fa fa-check"></i><b>15.1</b> Generalizing the linear regression model</a></li>
<li class="chapter" data-level="15.2" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>15.2</b> Logistic regression</a></li>
</ul></li>
<li class="part"><span><b>V Frequentist statistics</b></span></li>
<li class="chapter" data-level="16" data-path="ch-05-01-frequentist-hypothesis-testing.html"><a href="ch-05-01-frequentist-hypothesis-testing.html"><i class="fa fa-check"></i><b>16</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="16.1" data-path="ch-05-01-frequentist-testing-overview.html"><a href="ch-05-01-frequentist-testing-overview.html"><i class="fa fa-check"></i><b>16.1</b> Frequentist statistics: why &amp; how</a></li>
<li class="chapter" data-level="16.2" data-path="ch-03-05-hypothesis-p-values.html"><a href="ch-03-05-hypothesis-p-values.html"><i class="fa fa-check"></i><b>16.2</b> Quantifying evidence against a null-model with <em>p</em>-values</a><ul>
<li class="chapter" data-level="16.2.1" data-path="ch-03-05-hypothesis-p-values.html"><a href="ch-03-05-hypothesis-p-values.html#frequentist-null-models"><i class="fa fa-check"></i><b>16.2.1</b> Frequentist null-models</a></li>
<li class="chapter" data-level="16.2.2" data-path="ch-03-05-hypothesis-p-values.html"><a href="ch-03-05-hypothesis-p-values.html#one--vs.-two-sided-p-values"><i class="fa fa-check"></i><b>16.2.2</b> One- vs. two-sided <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="16.2.3" data-path="ch-03-05-hypothesis-p-values.html"><a href="ch-03-05-hypothesis-p-values.html#significance-categorical-decisions"><i class="fa fa-check"></i><b>16.2.3</b> Significance &amp; categorical decisions</a></li>
<li class="chapter" data-level="16.2.4" data-path="ch-03-05-hypothesis-p-values.html"><a href="ch-03-05-hypothesis-p-values.html#how-not-to-interpret-p-values"><i class="fa fa-check"></i><b>16.2.4</b> How (not) to interpret <em>p</em>-values</a></li>
<li class="chapter" data-level="16.2.5" data-path="ch-03-05-hypothesis-p-values.html"><a href="ch-03-05-hypothesis-p-values.html#excursion-distribution-of-p-values"><i class="fa fa-check"></i><b>16.2.5</b> [Excursion] Distribution of <span class="math inline">\(p\)</span>-values</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ch-03-05-hypothesis-testing-CLT.html"><a href="ch-03-05-hypothesis-testing-CLT.html"><i class="fa fa-check"></i><b>16.3</b> [Excursion] Central Limit Theorem</a></li>
<li class="chapter" data-level="16.4" data-path="ch-03-04-hypothesis-significance-errors.html"><a href="ch-03-04-hypothesis-significance-errors.html"><i class="fa fa-check"></i><b>16.4</b> [Excursion] The Neyman-Pearson approach</a></li>
<li class="chapter" data-level="16.5" data-path="ch-05-01-frequentist-testing-confidence-intervals.html"><a href="ch-05-01-frequentist-testing-confidence-intervals.html"><i class="fa fa-check"></i><b>16.5</b> Confidence intervals</a><ul>
<li class="chapter" data-level="16.5.1" data-path="ch-05-01-frequentist-testing-confidence-intervals.html"><a href="ch-05-01-frequentist-testing-confidence-intervals.html#relation-of-p-values-to-confidence-intervals"><i class="fa fa-check"></i><b>16.5.1</b> Relation of <em>p</em>-values to confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html"><i class="fa fa-check"></i><b>16.6</b> Selected tests</a><ul>
<li class="chapter" data-level="16.6.1" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html#ch-03-05-hypothesis-testing-Pearsons-Chi"><i class="fa fa-check"></i><b>16.6.1</b> Pearson’s <span class="math inline">\(\chi^2\)</span>-tests</a></li>
<li class="chapter" data-level="16.6.2" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html#ch-03-05-hypothesis-testing-z-test"><i class="fa fa-check"></i><b>16.6.2</b> <em>z</em>-test</a></li>
<li class="chapter" data-level="16.6.3" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html#ch-03-05-hypothesis-testing-t-test"><i class="fa fa-check"></i><b>16.6.3</b> <em>t</em>-tests</a></li>
<li class="chapter" data-level="16.6.4" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html#ch-03-05-hypothesis-testing-ANOVA"><i class="fa fa-check"></i><b>16.6.4</b> ANOVA</a></li>
<li class="chapter" data-level="16.6.5" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html#linear-regression"><i class="fa fa-check"></i><b>16.6.5</b> Linear regression</a></li>
<li class="chapter" data-level="16.6.6" data-path="ch-03-05-hypothesis-testing-tests.html"><a href="ch-03-05-hypothesis-testing-tests.html#Chap-05-01-LR-test"><i class="fa fa-check"></i><b>16.6.6</b> Likelihood-Ratio Test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ch-05-02-comparison-freq-Bayes.html"><a href="ch-05-02-comparison-freq-Bayes.html"><i class="fa fa-check"></i><b>17</b> Comparing frequentist and Bayesian statistics</a><ul>
<li class="chapter" data-level="17.1" data-path="frequentist-and-bayesian-statistical-models.html"><a href="frequentist-and-bayesian-statistical-models.html"><i class="fa fa-check"></i><b>17.1</b> Frequentist and Bayesian statistical models</a></li>
<li class="chapter" data-level="17.2" data-path="approximation-in-the-model-or-through-the-computation.html"><a href="approximation-in-the-model-or-through-the-computation.html"><i class="fa fa-check"></i><b>17.2</b> Approximation: in the model or through the computation</a></li>
<li class="chapter" data-level="17.3" data-path="mc-simulated-p-values.html"><a href="mc-simulated-p-values.html"><i class="fa fa-check"></i><b>17.3</b> MC-simulated <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="17.4" data-path="bayesian-p-values-model-checking.html"><a href="bayesian-p-values-model-checking.html"><i class="fa fa-check"></i><b>17.4</b> Bayesian <span class="math inline">\(p\)</span>-values &amp; model checking</a></li>
<li class="chapter" data-level="17.5" data-path="ch-05-01-estimation-comparison.html"><a href="ch-05-01-estimation-comparison.html"><i class="fa fa-check"></i><b>17.5</b> Comparing Bayesian and frequentist estimates</a></li>
<li class="chapter" data-level="17.6" data-path="beliefs-decisions-and-long-term-error.html"><a href="beliefs-decisions-and-long-term-error.html"><i class="fa fa-check"></i><b>17.6</b> Beliefs, decisions and long-term error</a></li>
<li class="chapter" data-level="17.7" data-path="evidence-for-the-null.html"><a href="evidence-for-the-null.html"><i class="fa fa-check"></i><b>17.7</b> Evidence for the null</a></li>
<li class="chapter" data-level="17.8" data-path="Chap-05-02-models-three-pillars.html"><a href="Chap-05-02-models-three-pillars.html"><i class="fa fa-check"></i><b>17.8</b> Three pillars of data analysis</a></li>
<li class="chapter" data-level="17.9" data-path="testing-hypotheses-by-estimation-comparison-model-checking.html"><a href="testing-hypotheses-by-estimation-comparison-model-checking.html"><i class="fa fa-check"></i><b>17.9</b> Testing hypotheses by estimation, comparison &amp; model checking</a></li>
<li class="chapter" data-level="17.10" data-path="jeffreys-lindley-paradox.html"><a href="jeffreys-lindley-paradox.html"><i class="fa fa-check"></i><b>17.10</b> Jeffreys-Lindley paradox</a></li>
<li class="chapter" data-level="17.11" data-path="explicit-beliefs-vs.-implicit-intentions.html"><a href="explicit-beliefs-vs.-implicit-intentions.html"><i class="fa fa-check"></i><b>17.11</b> Explicit beliefs vs. implicit intentions</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="app-90-further-material.html"><a href="app-90-further-material.html"><i class="fa fa-check"></i><b>A</b> Further useful material</a><ul>
<li class="chapter" data-level="A.1" data-path="material-on-introduction-to-probability.html"><a href="material-on-introduction-to-probability.html"><i class="fa fa-check"></i><b>A.1</b> Material on <em>Introduction to Probability</em>:</a></li>
<li class="chapter" data-level="A.2" data-path="material-on-bayesian-data-analysis.html"><a href="material-on-bayesian-data-analysis.html"><i class="fa fa-check"></i><b>A.2</b> Material on <em>Bayesian Data Analysis</em>:</a></li>
<li class="chapter" data-level="A.3" data-path="material-on-frequentist-statistics.html"><a href="material-on-frequentist-statistics.html"><i class="fa fa-check"></i><b>A.3</b> Material on <em>frequentist statistics</em>:</a></li>
<li class="chapter" data-level="A.4" data-path="material-on-r-tidyverse-etc..html"><a href="material-on-r-tidyverse-etc..html"><i class="fa fa-check"></i><b>A.4</b> Material on <em>R, tidyverse, etc.</em>:</a></li>
<li class="chapter" data-level="A.5" data-path="further-information-for-rstudio.html"><a href="further-information-for-rstudio.html"><i class="fa fa-check"></i><b>A.5</b> Further information for RStudio</a></li>
<li class="chapter" data-level="A.6" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html"><i class="fa fa-check"></i><b>A.6</b> Further information on WebPPL</a><ul>
<li class="chapter" data-level="A.6.1" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#primitives-and-sampling-functions"><i class="fa fa-check"></i><b>A.6.1</b> Primitives and sampling functions</a></li>
<li class="chapter" data-level="A.6.2" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#inference-with-infer"><i class="fa fa-check"></i><b>A.6.2</b> Inference with <code>Infer()</code></a></li>
<li class="chapter" data-level="A.6.3" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#visualization"><i class="fa fa-check"></i><b>A.6.3</b> Visualization</a></li>
<li class="chapter" data-level="A.6.4" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#installation"><i class="fa fa-check"></i><b>A.6.4</b> Installation</a></li>
<li class="chapter" data-level="A.6.5" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#usage"><i class="fa fa-check"></i><b>A.6.5</b> Usage</a></li>
<li class="chapter" data-level="A.6.6" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#keyboard-shortcuts-for-in-browser-use"><i class="fa fa-check"></i><b>A.6.6</b> Keyboard shortcuts (for in-browser use)</a></li>
<li class="chapter" data-level="A.6.7" data-path="further-information-on-webppl.html"><a href="further-information-on-webppl.html#further-resources"><i class="fa fa-check"></i><b>A.6.7</b> Further resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="app-91-distributions.html"><a href="app-91-distributions.html"><i class="fa fa-check"></i><b>B</b> Common probability distributions</a><ul>
<li class="chapter" data-level="B.1" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html"><i class="fa fa-check"></i><b>B.1</b> Selected continuous distributions of random variables</a><ul>
<li class="chapter" data-level="B.1.1" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#app-91-distributions-normal"><i class="fa fa-check"></i><b>B.1.1</b> Normal distribution</a></li>
<li class="chapter" data-level="B.1.2" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#app-91-distributions-chi2"><i class="fa fa-check"></i><b>B.1.2</b> Chi-squared distribution</a></li>
<li class="chapter" data-level="B.1.3" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#app-91-distributions-F"><i class="fa fa-check"></i><b>B.1.3</b> F-distribution</a></li>
<li class="chapter" data-level="B.1.4" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#app-91-distributions-students-t"><i class="fa fa-check"></i><b>B.1.4</b> Student’s <em>t</em>-distribution</a></li>
<li class="chapter" data-level="B.1.5" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#app-91-distributions-beta"><i class="fa fa-check"></i><b>B.1.5</b> Beta distribution</a></li>
<li class="chapter" data-level="B.1.6" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#uniform-distribution"><i class="fa fa-check"></i><b>B.1.6</b> Uniform distribution</a></li>
<li class="chapter" data-level="B.1.7" data-path="selected-continuous-distributions-of-random-variables.html"><a href="selected-continuous-distributions-of-random-variables.html#app-91-distributions-dirichlet"><i class="fa fa-check"></i><b>B.1.7</b> Dirichlet distribution</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html"><i class="fa fa-check"></i><b>B.2</b> Selected discrete distributions of random variables</a><ul>
<li class="chapter" data-level="B.2.1" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html#app-91-distributions-binomial"><i class="fa fa-check"></i><b>B.2.1</b> Binomial distribution</a></li>
<li class="chapter" data-level="B.2.2" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html#app-91-distributions-multinomial"><i class="fa fa-check"></i><b>B.2.2</b> Multinomial distribution</a></li>
<li class="chapter" data-level="B.2.3" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html#app-91-distributions-bernoulli"><i class="fa fa-check"></i><b>B.2.3</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="B.2.4" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html#app-91-distributions-categorical"><i class="fa fa-check"></i><b>B.2.4</b> Categorical distribution</a></li>
<li class="chapter" data-level="B.2.5" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html#app-91-distributions-beta-binomial"><i class="fa fa-check"></i><b>B.2.5</b> Beta-Binomial distribution</a></li>
<li class="chapter" data-level="B.2.6" data-path="selected-discrete-distributions-of-random-variables.html"><a href="selected-discrete-distributions-of-random-variables.html#poisson-distribution"><i class="fa fa-check"></i><b>B.2.6</b> Poisson distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="app-92-exponential-family.html"><a href="app-92-exponential-family.html"><i class="fa fa-check"></i><b>C</b> Exponential Family and Maximum Entropy</a><ul>
<li class="chapter" data-level="C.1" data-path="an-important-family-the-exponential-family.html"><a href="an-important-family-the-exponential-family.html"><i class="fa fa-check"></i><b>C.1</b> An important family: The Exponential Family</a></li>
<li class="chapter" data-level="C.2" data-path="the-maximum-entropy-principle.html"><a href="the-maximum-entropy-principle.html"><i class="fa fa-check"></i><b>C.2</b> The Maximum Entropy Principle</a><ul>
<li class="chapter" data-level="C.2.1" data-path="the-maximum-entropy-principle.html"><a href="the-maximum-entropy-principle.html#information-entropy"><i class="fa fa-check"></i><b>C.2.1</b> Information Entropy</a></li>
<li class="chapter" data-level="C.2.2" data-path="the-maximum-entropy-principle.html"><a href="the-maximum-entropy-principle.html#deriving-probability-distributions-using-the-maximum-entropy-principle"><i class="fa fa-check"></i><b>C.2.2</b> Deriving Probability Distributions using the Maximum Entropy Principle</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="app-93-data-sets.html"><a href="app-93-data-sets.html"><i class="fa fa-check"></i><b>D</b> Data sets used in the book</a><ul>
<li class="chapter" data-level="D.1" data-path="app-93-data-sets-mental-chronometry.html"><a href="app-93-data-sets-mental-chronometry.html"><i class="fa fa-check"></i><b>D.1</b> Mental Chronometry</a><ul>
<li class="chapter" data-level="D.1.1" data-path="app-93-data-sets-mental-chronometry.html"><a href="app-93-data-sets-mental-chronometry.html#nature-origin-and-rationale-of-the-data"><i class="fa fa-check"></i><b>D.1.1</b> Nature, origin and rationale of the data</a></li>
<li class="chapter" data-level="D.1.2" data-path="app-93-data-sets-mental-chronometry.html"><a href="app-93-data-sets-mental-chronometry.html#loading-and-preprocessing-the-data"><i class="fa fa-check"></i><b>D.1.2</b> Loading and preprocessing the data</a></li>
<li class="chapter" data-level="D.1.3" data-path="app-93-data-sets-mental-chronometry.html"><a href="app-93-data-sets-mental-chronometry.html#cleaning-the-data-1"><i class="fa fa-check"></i><b>D.1.3</b> Cleaning the data</a></li>
<li class="chapter" data-level="D.1.4" data-path="app-93-data-sets-mental-chronometry.html"><a href="app-93-data-sets-mental-chronometry.html#exploration-summary-stats-plots"><i class="fa fa-check"></i><b>D.1.4</b> Exploration: summary stats &amp; plots</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="app-93-data-sets-simon-task.html"><a href="app-93-data-sets-simon-task.html"><i class="fa fa-check"></i><b>D.2</b> Simon Task</a><ul>
<li class="chapter" data-level="D.2.1" data-path="app-93-data-sets-simon-task.html"><a href="app-93-data-sets-simon-task.html#experiment"><i class="fa fa-check"></i><b>D.2.1</b> Experiment</a></li>
<li class="chapter" data-level="D.2.2" data-path="app-93-data-sets-simon-task.html"><a href="app-93-data-sets-simon-task.html#hypotheses"><i class="fa fa-check"></i><b>D.2.2</b> Hypotheses</a></li>
<li class="chapter" data-level="D.2.3" data-path="app-93-data-sets-simon-task.html"><a href="app-93-data-sets-simon-task.html#results"><i class="fa fa-check"></i><b>D.2.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="app-93-data-sets-king-of-france.html"><a href="app-93-data-sets-king-of-france.html"><i class="fa fa-check"></i><b>D.3</b> King of France</a><ul>
<li class="chapter" data-level="D.3.1" data-path="app-93-data-sets-king-of-france.html"><a href="app-93-data-sets-king-of-france.html#app-93-data-sets-king-of-france-background"><i class="fa fa-check"></i><b>D.3.1</b> Nature, origin and rationale of the data</a></li>
<li class="chapter" data-level="D.3.2" data-path="app-93-data-sets-king-of-france.html"><a href="app-93-data-sets-king-of-france.html#loading-and-preprocessing-the-data-1"><i class="fa fa-check"></i><b>D.3.2</b> Loading and preprocessing the data</a></li>
<li class="chapter" data-level="D.3.3" data-path="app-93-data-sets-king-of-france.html"><a href="app-93-data-sets-king-of-france.html#cleaning-the-data-3"><i class="fa fa-check"></i><b>D.3.3</b> Cleaning the data</a></li>
<li class="chapter" data-level="D.3.4" data-path="app-93-data-sets-king-of-france.html"><a href="app-93-data-sets-king-of-france.html#exploration-summary-stats-plots-1"><i class="fa fa-check"></i><b>D.3.4</b> Exploration: summary stats &amp; plots</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="app-93-data-sets-BLJM.html"><a href="app-93-data-sets-BLJM.html"><i class="fa fa-check"></i><b>D.4</b> Bio-Logic Jazz-Metal (and where to consume it)</a><ul>
<li class="chapter" data-level="D.4.1" data-path="app-93-data-sets-BLJM.html"><a href="app-93-data-sets-BLJM.html#nature-origin-and-rationale-of-the-data-1"><i class="fa fa-check"></i><b>D.4.1</b> Nature, origin and rationale of the data</a></li>
<li class="chapter" data-level="D.4.2" data-path="app-93-data-sets-BLJM.html"><a href="app-93-data-sets-BLJM.html#loading-and-preprocessing-the-data-2"><i class="fa fa-check"></i><b>D.4.2</b> Loading and preprocessing the data</a></li>
<li class="chapter" data-level="D.4.3" data-path="app-93-data-sets-BLJM.html"><a href="app-93-data-sets-BLJM.html#exploration-counts-plots"><i class="fa fa-check"></i><b>D.4.3</b> Exploration: counts &amp; plots</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="app-93-data-sets-avocado.html"><a href="app-93-data-sets-avocado.html"><i class="fa fa-check"></i><b>D.5</b> Avocado prices</a><ul>
<li class="chapter" data-level="D.5.1" data-path="app-93-data-sets-avocado.html"><a href="app-93-data-sets-avocado.html#nature-origin-and-rationale-of-the-data-2"><i class="fa fa-check"></i><b>D.5.1</b> Nature, origin and rationale of the data</a></li>
<li class="chapter" data-level="D.5.2" data-path="app-93-data-sets-avocado.html"><a href="app-93-data-sets-avocado.html#loading-and-preprocessing-the-data-3"><i class="fa fa-check"></i><b>D.5.2</b> Loading and preprocessing the data</a></li>
<li class="chapter" data-level="D.5.3" data-path="app-93-data-sets-avocado.html"><a href="app-93-data-sets-avocado.html#summary-statistics"><i class="fa fa-check"></i><b>D.5.3</b> Summary statistics</a></li>
<li class="chapter" data-level="D.5.4" data-path="app-93-data-sets-avocado.html"><a href="app-93-data-sets-avocado.html#plots"><i class="fa fa-check"></i><b>D.5.4</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="D.6" data-path="app-93-data-sets-temperature.html"><a href="app-93-data-sets-temperature.html"><i class="fa fa-check"></i><b>D.6</b> Annual average world surface temperature</a><ul>
<li class="chapter" data-level="D.6.1" data-path="app-93-data-sets-temperature.html"><a href="app-93-data-sets-temperature.html#nature-origin-and-rationale-of-the-data-3"><i class="fa fa-check"></i><b>D.6.1</b> Nature, origin and rationale of the data</a></li>
<li class="chapter" data-level="D.6.2" data-path="app-93-data-sets-temperature.html"><a href="app-93-data-sets-temperature.html#loading-and-preprocessing-the-data-4"><i class="fa fa-check"></i><b>D.6.2</b> Loading and preprocessing the data</a></li>
<li class="chapter" data-level="D.6.3" data-path="app-93-data-sets-temperature.html"><a href="app-93-data-sets-temperature.html#hypothesis-modeling-approach"><i class="fa fa-check"></i><b>D.6.3</b> Hypothesis &amp; modeling approach</a></li>
<li class="chapter" data-level="D.6.4" data-path="app-93-data-sets-temperature.html"><a href="app-93-data-sets-temperature.html#plotting"><i class="fa fa-check"></i><b>D.6.4</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="D.7" data-path="app-93-data-sets-murder-data.html"><a href="app-93-data-sets-murder-data.html"><i class="fa fa-check"></i><b>D.7</b> Murder data</a><ul>
<li class="chapter" data-level="D.7.1" data-path="app-93-data-sets-murder-data.html"><a href="app-93-data-sets-murder-data.html#nature-origin-and-rationale-of-the-data-4"><i class="fa fa-check"></i><b>D.7.1</b> Nature, origin and rationale of the data</a></li>
</ul></li>
<li class="chapter" data-level="D.8" data-path="app-93-data-sets-politeness.html"><a href="app-93-data-sets-politeness.html"><i class="fa fa-check"></i><b>D.8</b> Politeness data</a><ul>
<li class="chapter" data-level="D.8.1" data-path="app-93-data-sets-politeness.html"><a href="app-93-data-sets-politeness.html#nature-origin-and-rationale-of-the-data-5"><i class="fa fa-check"></i><b>D.8.1</b> Nature, origin and rationale of the data</a></li>
<li class="chapter" data-level="D.8.2" data-path="app-93-data-sets-politeness.html"><a href="app-93-data-sets-politeness.html#hypotheses-2"><i class="fa fa-check"></i><b>D.8.2</b> Hypotheses</a></li>
<li class="chapter" data-level="D.8.3" data-path="app-93-data-sets-politeness.html"><a href="app-93-data-sets-politeness.html#summary-statistics-1"><i class="fa fa-check"></i><b>D.8.3</b> Summary statistics</a></li>
<li class="chapter" data-level="D.8.4" data-path="app-93-data-sets-politeness.html"><a href="app-93-data-sets-politeness.html#visualization-1"><i class="fa fa-check"></i><b>D.8.4</b> Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="app-94-open-science.html"><a href="app-94-open-science.html"><i class="fa fa-check"></i><b>E</b> Open science practices</a><ul>
<li class="chapter" data-level="E.1" data-path="app-94-replication-crisis.html"><a href="app-94-replication-crisis.html"><i class="fa fa-check"></i><b>E.1</b> Psychology’s replication crisis</a><ul>
<li class="chapter" data-level="E.1.1" data-path="app-94-replication-crisis.html"><a href="app-94-replication-crisis.html#publication-bias-qrps-and-false-positives"><i class="fa fa-check"></i><b>E.1.1</b> Publication bias, QRP’s, and false-positives</a></li>
<li class="chapter" data-level="E.1.2" data-path="app-94-replication-crisis.html"><a href="app-94-replication-crisis.html#low-statistical-power"><i class="fa fa-check"></i><b>E.1.2</b> Low statistical power</a></li>
<li class="chapter" data-level="E.1.3" data-path="app-94-replication-crisis.html"><a href="app-94-replication-crisis.html#lack-of-transparency"><i class="fa fa-check"></i><b>E.1.3</b> Lack of transparency</a></li>
</ul></li>
<li class="chapter" data-level="E.2" data-path="app-94-remedies.html"><a href="app-94-remedies.html"><i class="fa fa-check"></i><b>E.2</b> Possible remedies</a><ul>
<li class="chapter" data-level="E.2.1" data-path="app-94-remedies.html"><a href="app-94-remedies.html#improve-scientific-rigor"><i class="fa fa-check"></i><b>E.2.1</b> Improve scientific rigor</a></li>
<li class="chapter" data-level="E.2.2" data-path="app-94-remedies.html"><a href="app-94-remedies.html#realigning-incentive-structures"><i class="fa fa-check"></i><b>E.2.2</b> Realigning incentive structures</a></li>
<li class="chapter" data-level="E.2.3" data-path="app-94-remedies.html"><a href="app-94-remedies.html#promote-transparency"><i class="fa fa-check"></i><b>E.2.3</b> Promote transparency</a></li>
</ul></li>
<li class="chapter" data-level="E.3" data-path="app-94-recap.html"><a href="app-94-recap.html"><i class="fa fa-check"></i><b>E.3</b> Chapter summary</a></li>
<li class="chapter" data-level="E.4" data-path="app-94-resources.html"><a href="app-94-resources.html"><i class="fa fa-check"></i><b>E.4</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chap-02-04-ggplot" class="section level2">
<h2><span class="header-section-number">6.3</span> Basics of <code>ggplot</code></h2>
<p>In this section, we will work towards a first plot with <code>ggplot</code>. It will be a scatter plot (more on different kinds of plots in Section <a href="Chap-02-04-geoms.html#Chap-02-04-geoms">6.4</a>) for the <a href="app-93-data-sets-avocado.html#app-93-data-sets-avocado">avocado price data</a>. Check out the <a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">ggplot cheat sheet</a> for a quick overview of the nuts and bolts of ggplot.</p>
<p>The following paragraphs introduce the key concepts of <code>ggplot</code>:</p>
<ul>
<li><strong>incremental composition</strong>: adding elements or changing attributes of a plot incrementally</li>
<li><strong>convenience functions &amp; defaults</strong>: a closer look at high-level convenience functions (like <code>geom_point</code>) and what they actually do</li>
<li><strong>layers</strong>: seeing how layers are stacked when we call, e.g. different <code>geom_</code> functions in sequence</li>
<li><strong>grouping</strong>: what happens when we use grouping information (e.g., for color, shape or in facets)</li>
</ul>
<p>The section finishes with a first full example of a plot that has different layers, uses grouping, and customizes a few other things.</p>
<p>To get started, let’s first load the (preprocessed) avocado data set used for plotting:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="Chap-02-04-ggplot.html#cb359-1"></a>avocado_data &lt;-<span class="st"> </span>aida<span class="op">::</span>data_avocado</span></code></pre></div>
<div id="incremental-composition-of-a-plot" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Incremental composition of a plot</h3>
<p>The “gg” in the package name <code>ggplot</code> is short for “grammar of graphs”. It provides functions for describing scientific data plots in a compositional manner, i.e., for dealing with different recurrent elements in a plot in an additive way. As a result of this approach, we will use the symbol <code>+</code> to <em>add</em> more and more elements (or to override the implicit defaults in previously evoked elements) to build a plot. For example, we can obtain a scatter plot for the <a href="app-93-data-sets-avocado.html#app-93-data-sets-avocado">avocado price data</a> simply by first calling the function <code>ggplot</code>, which just creates an empty plot:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="Chap-02-04-ggplot.html#cb360-1"></a>incrementally_built_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>()</span></code></pre></div>
<p>The plot stored in variable <code>incrementally_built_plot</code> is very boring. Take a look:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="Chap-02-04-ggplot.html#cb361-1"></a>incrementally_built_plot</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-201-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As you can see, you do not see anything except a (white) canvas. But we can add some stuff. Don’t get hung up on the details right now, just notice that we use <code>+</code> to add stuff to our plot:<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="Chap-02-04-ggplot.html#cb362-1"></a>incrementally_built_plot <span class="op">+</span><span class="st"> </span></span>
<span id="cb362-2"><a href="Chap-02-04-ggplot.html#cb362-2"></a><span class="st">  </span><span class="co"># add a geom of type `point` (=&gt; scatter plot)</span></span>
<span id="cb362-3"><a href="Chap-02-04-ggplot.html#cb362-3"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb362-4"><a href="Chap-02-04-ggplot.html#cb362-4"></a>    <span class="co"># what data to use</span></span>
<span id="cb362-5"><a href="Chap-02-04-ggplot.html#cb362-5"></a>    <span class="dt">data =</span> avocado_data, </span>
<span id="cb362-6"><a href="Chap-02-04-ggplot.html#cb362-6"></a>    <span class="co"># supply a mapping (in the form of an &#39;aesthetic&#39; (see below))</span></span>
<span id="cb362-7"><a href="Chap-02-04-ggplot.html#cb362-7"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb362-8"><a href="Chap-02-04-ggplot.html#cb362-8"></a>      <span class="co"># which variable to map onto the x-axis</span></span>
<span id="cb362-9"><a href="Chap-02-04-ggplot.html#cb362-9"></a>      <span class="dt">x =</span> total_volume_sold,</span>
<span id="cb362-10"><a href="Chap-02-04-ggplot.html#cb362-10"></a>      <span class="co"># which variable to map onto the y-axis</span></span>
<span id="cb362-11"><a href="Chap-02-04-ggplot.html#cb362-11"></a>      <span class="dt">y =</span> average_price</span>
<span id="cb362-12"><a href="Chap-02-04-ggplot.html#cb362-12"></a>      )</span>
<span id="cb362-13"><a href="Chap-02-04-ggplot.html#cb362-13"></a>  )</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-202-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You see that the function <code>geom_point</code> is what makes the points appear. You tell it which data to use and which mapping of variables from the data set to elements in the plot you like. That’s it, at least to begin with.</p>
<p>We can also supply the information about the data to use and the aesthetic mapping in the <code>ggplot</code> function call. Doing so will make this information the default for any subsequently added layer. Notice also that the <code>data</code> argument in function <code>ggplot</code> is the first argument, so we will frequently make use of piping, like in the following code which is equivalent to the previous in terms of output:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="Chap-02-04-ggplot.html#cb363-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb363-2"><a href="Chap-02-04-ggplot.html#cb363-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> total_volume_sold, <span class="dt">y =</span> average_price)) <span class="op">+</span></span>
<span id="cb363-3"><a href="Chap-02-04-ggplot.html#cb363-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-203-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="elements-in-the-layered-grammar-of-graphs" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Elements in the layered grammar of graphs</h3>
<p>Let’s take a step back. Actually, the function <code>geom_point</code> is a convenience function that does a lot of things automatically for us. It helps to understand subsequent code if we peek under the hood at least for a brief moment initially, if only to just realize where some of the terminology in and around the “grammar of graphs” comes from.</p>
<p>The <code>ggplot</code> package defines a <strong>layered grammar of graphs</strong> <span class="citation">(Wickham <a href="#ref-Wickham2010:A-Layered-Gramm" role="doc-biblioref">2010</a>)</span>. This is a structured description language for plots (relevant for data science). It uses a smart system of defaults so that it suffices to often just call a convenience wrapper like <code>geom_point</code>. But underneath, there is the possibility of tinkering with (almost?) all of the (layered) elements and changing the defaults if need be.</p>
<p>The process of mapping data onto a visualization essentially follows this route:</p>
<blockquote>
<p>data -&gt; statistical transformation -&gt; geom. object -&gt; aesthetics</p>
</blockquote>
<p>You supply (tidy) data. The data is then transformed (e.g., by computing a summary statistic) in some way or another. This could just be an “identity map” in which case you will visualize the data exactly as it is. The resulting data representation is mapped onto some spatial (geometric) appearance, like a line, a dot, or a geometric shape. Finally, there is room to alter the specific aesthetics of this mapping from data to visual object, like adjusting the size or the color of a geometric object, possibly depending on some other properties it has (e.g., whether it is an observation for a conventional or an organically grown avocado).</p>
<p>To make explicit the steps which are implicitly carried out by <code>geom_point</code> in the example above, here is a fully verbose but output-equivalent sequence of commands that builds the same plot by defining all the basic components manually:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="Chap-02-04-ggplot.html#cb364-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb364-2"><a href="Chap-02-04-ggplot.html#cb364-2"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb364-3"><a href="Chap-02-04-ggplot.html#cb364-3"></a><span class="st">  </span><span class="co"># plot consists of layers (more on this soon)</span></span>
<span id="cb364-4"><a href="Chap-02-04-ggplot.html#cb364-4"></a><span class="st">  </span><span class="kw">layer</span>(</span>
<span id="cb364-5"><a href="Chap-02-04-ggplot.html#cb364-5"></a>    <span class="co"># how to map columns onto ingredients in the plot</span></span>
<span id="cb364-6"><a href="Chap-02-04-ggplot.html#cb364-6"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_volume_sold, <span class="dt">y =</span> average_price),</span>
<span id="cb364-7"><a href="Chap-02-04-ggplot.html#cb364-7"></a>    <span class="co"># what statistical transformation should be used? - here: none</span></span>
<span id="cb364-8"><a href="Chap-02-04-ggplot.html#cb364-8"></a>    <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb364-9"><a href="Chap-02-04-ggplot.html#cb364-9"></a>    <span class="co"># how should the transformed data be visually represented? - here: as points</span></span>
<span id="cb364-10"><a href="Chap-02-04-ggplot.html#cb364-10"></a>    <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb364-11"><a href="Chap-02-04-ggplot.html#cb364-11"></a>    <span class="co"># should we tinker in any other way with the positioning of each element?</span></span>
<span id="cb364-12"><a href="Chap-02-04-ggplot.html#cb364-12"></a>    <span class="co"># - here: no, thank you!</span></span>
<span id="cb364-13"><a href="Chap-02-04-ggplot.html#cb364-13"></a>    <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span></span>
<span id="cb364-14"><a href="Chap-02-04-ggplot.html#cb364-14"></a>  ) <span class="op">+</span></span>
<span id="cb364-15"><a href="Chap-02-04-ggplot.html#cb364-15"></a><span class="st">  </span><span class="co"># x and y axes are non-transformed continuous</span></span>
<span id="cb364-16"><a href="Chap-02-04-ggplot.html#cb364-16"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>() <span class="op">+</span></span>
<span id="cb364-17"><a href="Chap-02-04-ggplot.html#cb364-17"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>() <span class="op">+</span></span>
<span id="cb364-18"><a href="Chap-02-04-ggplot.html#cb364-18"></a><span class="st">  </span><span class="co"># we use a cartesian coordinate system (not a polar or a geographical map)</span></span>
<span id="cb364-19"><a href="Chap-02-04-ggplot.html#cb364-19"></a><span class="st">  </span><span class="kw">coord_cartesian</span>()</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-205-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In this explicit call, we still need to specify the data and the mapping (which variable to map onto which axis). But we need to specify much more. We tell <code>ggplot</code> that we want standard (e.g., not log-transformed) axes. We also tell it that our axes are continuous, that the data should not be transformed and that the visual shape (= geom) to which the data is to be mapped is a point (hence the name <code>geom_point</code>).</p>
<p>It is not important to understand all of these components right now. It is important to have seen them once, and to understand that <code>geom_point</code> is a wrapper around this call which assumes reasonable defaults (such as non-transformed axes, points for representation etc.).</p>
</div>
<div id="layers-and-groups" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Layers and groups</h3>
<p><code>ggplot</code> is the “grammar of <em>layered</em> graphs”. Plots are compositionally built by combining different layers, if need be. For example, we can use another function from the <code>geom_</code> family of functions to display a different visualization derived from the same data on top of our previous scatter plot.<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a></p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="Chap-02-04-ggplot.html#cb365-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb365-2"><a href="Chap-02-04-ggplot.html#cb365-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb365-3"><a href="Chap-02-04-ggplot.html#cb365-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb365-4"><a href="Chap-02-04-ggplot.html#cb365-4"></a>      <span class="co"># notice that we use the log (try without it to understand why)</span></span>
<span id="cb365-5"><a href="Chap-02-04-ggplot.html#cb365-5"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb365-6"><a href="Chap-02-04-ggplot.html#cb365-6"></a>      <span class="dt">y =</span> average_price</span>
<span id="cb365-7"><a href="Chap-02-04-ggplot.html#cb365-7"></a>    )</span>
<span id="cb365-8"><a href="Chap-02-04-ggplot.html#cb365-8"></a>  ) <span class="op">+</span></span>
<span id="cb365-9"><a href="Chap-02-04-ggplot.html#cb365-9"></a><span class="st">  </span><span class="co"># add a scatter plot</span></span>
<span id="cb365-10"><a href="Chap-02-04-ggplot.html#cb365-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb365-11"><a href="Chap-02-04-ggplot.html#cb365-11"></a><span class="st">  </span><span class="co"># add a linear regression line</span></span>
<span id="cb365-12"><a href="Chap-02-04-ggplot.html#cb365-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-206-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that layering is really sequential. To see this, just check what happens when we reverse the calls of the <code>geom_</code> functions in the previous example:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="Chap-02-04-ggplot.html#cb366-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb366-2"><a href="Chap-02-04-ggplot.html#cb366-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb366-3"><a href="Chap-02-04-ggplot.html#cb366-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb366-4"><a href="Chap-02-04-ggplot.html#cb366-4"></a>      <span class="co"># notice that we use the log (try without it to understand why)</span></span>
<span id="cb366-5"><a href="Chap-02-04-ggplot.html#cb366-5"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb366-6"><a href="Chap-02-04-ggplot.html#cb366-6"></a>      <span class="dt">y =</span> average_price</span>
<span id="cb366-7"><a href="Chap-02-04-ggplot.html#cb366-7"></a>    )</span>
<span id="cb366-8"><a href="Chap-02-04-ggplot.html#cb366-8"></a>  ) <span class="op">+</span></span>
<span id="cb366-9"><a href="Chap-02-04-ggplot.html#cb366-9"></a><span class="st">  </span><span class="co"># FIRST: add a linear regression line</span></span>
<span id="cb366-10"><a href="Chap-02-04-ggplot.html#cb366-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb366-11"><a href="Chap-02-04-ggplot.html#cb366-11"></a><span class="st">  </span><span class="co"># THEN: add a scatter plot</span></span>
<span id="cb366-12"><a href="Chap-02-04-ggplot.html#cb366-12"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-207-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you want lower layers to be visible behind layers added later, one possibility is to tinker with opacity, via the <code>alpha</code> parameter. Notice that the example below also changes the colors. The result is quite toxic, but at least you see the line underneath the semi-transparent points.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="Chap-02-04-ggplot.html#cb367-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb367-2"><a href="Chap-02-04-ggplot.html#cb367-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb367-3"><a href="Chap-02-04-ggplot.html#cb367-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb367-4"><a href="Chap-02-04-ggplot.html#cb367-4"></a>      <span class="co"># notice that we use the log (try without it to understand why)</span></span>
<span id="cb367-5"><a href="Chap-02-04-ggplot.html#cb367-5"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb367-6"><a href="Chap-02-04-ggplot.html#cb367-6"></a>      <span class="dt">y =</span> average_price</span>
<span id="cb367-7"><a href="Chap-02-04-ggplot.html#cb367-7"></a>    )</span>
<span id="cb367-8"><a href="Chap-02-04-ggplot.html#cb367-8"></a>  ) <span class="op">+</span></span>
<span id="cb367-9"><a href="Chap-02-04-ggplot.html#cb367-9"></a><span class="st">  </span><span class="co"># FIRST: add a linear regression line</span></span>
<span id="cb367-10"><a href="Chap-02-04-ggplot.html#cb367-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="op">+</span></span>
<span id="cb367-11"><a href="Chap-02-04-ggplot.html#cb367-11"></a><span class="st">  </span><span class="co"># THEN: add a scatter plot</span></span>
<span id="cb367-12"><a href="Chap-02-04-ggplot.html#cb367-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-208-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The aesthetics defined in the initial call to <code>ggplot</code> are global defaults for all layers to follow, unless they are overwritten. This also holds for the data supplied to <code>ggplot</code>. For example, we can create a second layer using another call to <code>geom_point</code> from a second data set (e.g., with a summary statistic), like so:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="Chap-02-04-ggplot.html#cb368-1"></a><span class="co"># create a small tibble with the means of both</span></span>
<span id="cb368-2"><a href="Chap-02-04-ggplot.html#cb368-2"></a><span class="co">#   variables of interest</span></span>
<span id="cb368-3"><a href="Chap-02-04-ggplot.html#cb368-3"></a>avocado_data_means &lt;-<span class="st"> </span></span>
<span id="cb368-4"><a href="Chap-02-04-ggplot.html#cb368-4"></a><span class="st">  </span>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb368-5"><a href="Chap-02-04-ggplot.html#cb368-5"></a><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb368-6"><a href="Chap-02-04-ggplot.html#cb368-6"></a>    <span class="dt">mean_volume =</span> <span class="kw">mean</span>(<span class="kw">log</span>(total_volume_sold)),</span>
<span id="cb368-7"><a href="Chap-02-04-ggplot.html#cb368-7"></a>    <span class="dt">mean_price  =</span> <span class="kw">mean</span>(average_price)</span>
<span id="cb368-8"><a href="Chap-02-04-ggplot.html#cb368-8"></a>  )</span>
<span id="cb368-9"><a href="Chap-02-04-ggplot.html#cb368-9"></a>avocado_data_means</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   mean_volume mean_price
##         &lt;dbl&gt;      &lt;dbl&gt;
## 1        11.3       1.41</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="Chap-02-04-ggplot.html#cb370-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb370-2"><a href="Chap-02-04-ggplot.html#cb370-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb370-3"><a href="Chap-02-04-ggplot.html#cb370-3"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb370-4"><a href="Chap-02-04-ggplot.html#cb370-4"></a>        <span class="dt">y =</span> average_price)</span>
<span id="cb370-5"><a href="Chap-02-04-ggplot.html#cb370-5"></a>  ) <span class="op">+</span></span>
<span id="cb370-6"><a href="Chap-02-04-ggplot.html#cb370-6"></a><span class="st">  </span><span class="co"># first layer uses globally declared data &amp; mapping</span></span>
<span id="cb370-7"><a href="Chap-02-04-ggplot.html#cb370-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb370-8"><a href="Chap-02-04-ggplot.html#cb370-8"></a><span class="st">  </span><span class="co"># second layer uses different data set &amp; mapping</span></span>
<span id="cb370-9"><a href="Chap-02-04-ggplot.html#cb370-9"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb370-10"><a href="Chap-02-04-ggplot.html#cb370-10"></a>    <span class="dt">data =</span> avocado_data_means,</span>
<span id="cb370-11"><a href="Chap-02-04-ggplot.html#cb370-11"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb370-12"><a href="Chap-02-04-ggplot.html#cb370-12"></a>      <span class="dt">x =</span> mean_volume,</span>
<span id="cb370-13"><a href="Chap-02-04-ggplot.html#cb370-13"></a>      <span class="dt">y =</span> mean_price</span>
<span id="cb370-14"><a href="Chap-02-04-ggplot.html#cb370-14"></a>    ), </span>
<span id="cb370-15"><a href="Chap-02-04-ggplot.html#cb370-15"></a>    <span class="co"># change shape of element to display (see below)</span></span>
<span id="cb370-16"><a href="Chap-02-04-ggplot.html#cb370-16"></a>    <span class="dt">shape =</span> <span class="dv">9</span>,</span>
<span id="cb370-17"><a href="Chap-02-04-ggplot.html#cb370-17"></a>    <span class="co"># change size of element to display</span></span>
<span id="cb370-18"><a href="Chap-02-04-ggplot.html#cb370-18"></a>    <span class="dt">size =</span> <span class="dv">12</span>,</span>
<span id="cb370-19"><a href="Chap-02-04-ggplot.html#cb370-19"></a>    <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span></span>
<span id="cb370-20"><a href="Chap-02-04-ggplot.html#cb370-20"></a>  )</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-210-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="grouping" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Grouping</h3>
<p>Categorical distinction is frequently important in data analysis. Just think of the different combinations of factor levels in a factorial design, or the difference between conventionally grown and organically grown avocados. <code>ggplot</code> understands grouping very well and acts on appropriately, if you tell it to in the right way.</p>
<p>Grouping can be relevant for different aspects of a plot: the color of points or lines, their shape, or even whether to plot everything together or separately. For instance, we might want to display different types of avocados in a different color. We can do this like so:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="Chap-02-04-ggplot.html#cb371-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb371-2"><a href="Chap-02-04-ggplot.html#cb371-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb371-3"><a href="Chap-02-04-ggplot.html#cb371-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb371-4"><a href="Chap-02-04-ggplot.html#cb371-4"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold), </span>
<span id="cb371-5"><a href="Chap-02-04-ggplot.html#cb371-5"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb371-6"><a href="Chap-02-04-ggplot.html#cb371-6"></a>      <span class="co"># use a different color for each type of avocado</span></span>
<span id="cb371-7"><a href="Chap-02-04-ggplot.html#cb371-7"></a>      <span class="dt">color =</span> type</span>
<span id="cb371-8"><a href="Chap-02-04-ggplot.html#cb371-8"></a>    )</span>
<span id="cb371-9"><a href="Chap-02-04-ggplot.html#cb371-9"></a>  ) <span class="op">+</span></span>
<span id="cb371-10"><a href="Chap-02-04-ggplot.html#cb371-10"></a><span class="st">  </span><span class="kw">geom_point</span>()  </span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-211-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that we added the grouping information inside of <code>aes</code> to the call of <code>ggplot</code>. This way the grouping is the global default for the whole plot. Check what happens when we then add another layer, like <code>geom_smooth</code>:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="Chap-02-04-ggplot.html#cb372-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb372-2"><a href="Chap-02-04-ggplot.html#cb372-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb372-3"><a href="Chap-02-04-ggplot.html#cb372-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb372-4"><a href="Chap-02-04-ggplot.html#cb372-4"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold), </span>
<span id="cb372-5"><a href="Chap-02-04-ggplot.html#cb372-5"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb372-6"><a href="Chap-02-04-ggplot.html#cb372-6"></a>      <span class="co"># use a different color for each type of avocado</span></span>
<span id="cb372-7"><a href="Chap-02-04-ggplot.html#cb372-7"></a>      <span class="dt">color =</span> type</span>
<span id="cb372-8"><a href="Chap-02-04-ggplot.html#cb372-8"></a>    )</span>
<span id="cb372-9"><a href="Chap-02-04-ggplot.html#cb372-9"></a>  ) <span class="op">+</span></span>
<span id="cb372-10"><a href="Chap-02-04-ggplot.html#cb372-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb372-11"><a href="Chap-02-04-ggplot.html#cb372-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-212-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The regression lines will also be shown in the colors of the underlying scatter plot. We can change this by overwriting the <code>color</code> attribute locally, but then we lose the grouping information:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="Chap-02-04-ggplot.html#cb373-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb373-2"><a href="Chap-02-04-ggplot.html#cb373-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb373-3"><a href="Chap-02-04-ggplot.html#cb373-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb373-4"><a href="Chap-02-04-ggplot.html#cb373-4"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold), </span>
<span id="cb373-5"><a href="Chap-02-04-ggplot.html#cb373-5"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb373-6"><a href="Chap-02-04-ggplot.html#cb373-6"></a>      <span class="co"># use a different color for each type of avocado</span></span>
<span id="cb373-7"><a href="Chap-02-04-ggplot.html#cb373-7"></a>      <span class="dt">color =</span> type</span>
<span id="cb373-8"><a href="Chap-02-04-ggplot.html#cb373-8"></a>    )</span>
<span id="cb373-9"><a href="Chap-02-04-ggplot.html#cb373-9"></a>  ) <span class="op">+</span></span>
<span id="cb373-10"><a href="Chap-02-04-ggplot.html#cb373-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb373-11"><a href="Chap-02-04-ggplot.html#cb373-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-213-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To retrieve the grouping information, we can change the explicit keyword <code>group</code> (which just treats data from the relevant factor levels differently without directly changing their appearance):</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="Chap-02-04-ggplot.html#cb374-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb374-2"><a href="Chap-02-04-ggplot.html#cb374-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb374-3"><a href="Chap-02-04-ggplot.html#cb374-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb374-4"><a href="Chap-02-04-ggplot.html#cb374-4"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold), </span>
<span id="cb374-5"><a href="Chap-02-04-ggplot.html#cb374-5"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb374-6"><a href="Chap-02-04-ggplot.html#cb374-6"></a>      <span class="co"># use a different color for each type of avocado</span></span>
<span id="cb374-7"><a href="Chap-02-04-ggplot.html#cb374-7"></a>      <span class="dt">color =</span> type</span>
<span id="cb374-8"><a href="Chap-02-04-ggplot.html#cb374-8"></a>    )</span>
<span id="cb374-9"><a href="Chap-02-04-ggplot.html#cb374-9"></a>  ) <span class="op">+</span></span>
<span id="cb374-10"><a href="Chap-02-04-ggplot.html#cb374-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb374-11"><a href="Chap-02-04-ggplot.html#cb374-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(</span>
<span id="cb374-12"><a href="Chap-02-04-ggplot.html#cb374-12"></a>    <span class="co"># tell the smoother to deal with avocados types separately</span></span>
<span id="cb374-13"><a href="Chap-02-04-ggplot.html#cb374-13"></a>    <span class="kw">aes</span>(<span class="dt">group =</span> type),</span>
<span id="cb374-14"><a href="Chap-02-04-ggplot.html#cb374-14"></a>    <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb374-15"><a href="Chap-02-04-ggplot.html#cb374-15"></a>    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb374-16"><a href="Chap-02-04-ggplot.html#cb374-16"></a>  )</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-214-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Finally, we see that the lines are not uniquely associable with the avocado type, so we can also change the regression line’s <code>shape</code> attribute conditional on avocado type:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="Chap-02-04-ggplot.html#cb375-1"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb375-2"><a href="Chap-02-04-ggplot.html#cb375-2"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb375-3"><a href="Chap-02-04-ggplot.html#cb375-3"></a>    <span class="kw">aes</span>(</span>
<span id="cb375-4"><a href="Chap-02-04-ggplot.html#cb375-4"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold), </span>
<span id="cb375-5"><a href="Chap-02-04-ggplot.html#cb375-5"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb375-6"><a href="Chap-02-04-ggplot.html#cb375-6"></a>      <span class="co"># use a different color for each type of avocado</span></span>
<span id="cb375-7"><a href="Chap-02-04-ggplot.html#cb375-7"></a>      <span class="dt">color =</span> type</span>
<span id="cb375-8"><a href="Chap-02-04-ggplot.html#cb375-8"></a>    )</span>
<span id="cb375-9"><a href="Chap-02-04-ggplot.html#cb375-9"></a>  ) <span class="op">+</span></span>
<span id="cb375-10"><a href="Chap-02-04-ggplot.html#cb375-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb375-11"><a href="Chap-02-04-ggplot.html#cb375-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(</span>
<span id="cb375-12"><a href="Chap-02-04-ggplot.html#cb375-12"></a>    <span class="co"># tell the smoother to deal with avocados types separately</span></span>
<span id="cb375-13"><a href="Chap-02-04-ggplot.html#cb375-13"></a>    <span class="kw">aes</span>(<span class="dt">group =</span> type, <span class="dt">linetype =</span> type),</span>
<span id="cb375-14"><a href="Chap-02-04-ggplot.html#cb375-14"></a>    <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, </span>
<span id="cb375-15"><a href="Chap-02-04-ggplot.html#cb375-15"></a>    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb375-16"><a href="Chap-02-04-ggplot.html#cb375-16"></a>  )</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-215-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="example-of-a-customized-plot" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Example of a customized plot</h3>
<p>If done with the proper mind and heart, plots intended to share (and to communicate a point, following the idea of hypothesis-driven visualization) will usually require a lot of tweaking. We will cover some of the most frequently relevant tweaks in Section <a href="Chap-02-04-customization.html#Chap-02-04-customization">6.6</a>.</p>
<p>To nevertheless get a feeling of where the journey is going, at least roughly, here is an example of a plot of the avocado data which is much more tweaked and honed. No claim is intended regarding the false idea that this plot is in any sense optimal. There is not even a clear hypothesis or point to communicate. This just showcases some functionality. Notice, for instance, that this plot uses two layers, invoked by <code>geom_point</code> which shows the scatter plot of points and <code>geom_smooth</code> which layers on top the point cloud regression lines (one for each level in the grouping variable).</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="Chap-02-04-ggplot.html#cb376-1"></a><span class="co"># pipe data set into function `ggplot`</span></span>
<span id="cb376-2"><a href="Chap-02-04-ggplot.html#cb376-2"></a>avocado_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb376-3"><a href="Chap-02-04-ggplot.html#cb376-3"></a><span class="st">  </span><span class="co"># reverse factor level so that horizontal legend entries align with</span></span>
<span id="cb376-4"><a href="Chap-02-04-ggplot.html#cb376-4"></a><span class="st">  </span><span class="co"># the majority of observations of each group in the plot</span></span>
<span id="cb376-5"><a href="Chap-02-04-ggplot.html#cb376-5"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb376-6"><a href="Chap-02-04-ggplot.html#cb376-6"></a>    <span class="dt">type =</span> <span class="kw">fct_rev</span>(type)</span>
<span id="cb376-7"><a href="Chap-02-04-ggplot.html#cb376-7"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb376-8"><a href="Chap-02-04-ggplot.html#cb376-8"></a><span class="st">  </span><span class="co"># initialize the plot</span></span>
<span id="cb376-9"><a href="Chap-02-04-ggplot.html#cb376-9"></a><span class="st">  </span><span class="kw">ggplot</span>(</span>
<span id="cb376-10"><a href="Chap-02-04-ggplot.html#cb376-10"></a>    <span class="co"># defined mapping</span></span>
<span id="cb376-11"><a href="Chap-02-04-ggplot.html#cb376-11"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb376-12"><a href="Chap-02-04-ggplot.html#cb376-12"></a>      <span class="co"># which variable goes on the x-axis</span></span>
<span id="cb376-13"><a href="Chap-02-04-ggplot.html#cb376-13"></a>      <span class="dt">x =</span> total_volume_sold, </span>
<span id="cb376-14"><a href="Chap-02-04-ggplot.html#cb376-14"></a>      <span class="co"># which variable goes on the y-axis</span></span>
<span id="cb376-15"><a href="Chap-02-04-ggplot.html#cb376-15"></a>      <span class="dt">y =</span> average_price, </span>
<span id="cb376-16"><a href="Chap-02-04-ggplot.html#cb376-16"></a>      <span class="co"># which groups of variables to distinguish</span></span>
<span id="cb376-17"><a href="Chap-02-04-ggplot.html#cb376-17"></a>      <span class="dt">group =</span> type, </span>
<span id="cb376-18"><a href="Chap-02-04-ggplot.html#cb376-18"></a>      <span class="co"># color and fill to change by grouping variable</span></span>
<span id="cb376-19"><a href="Chap-02-04-ggplot.html#cb376-19"></a>      <span class="dt">fill =</span> type, </span>
<span id="cb376-20"><a href="Chap-02-04-ggplot.html#cb376-20"></a>      <span class="dt">linetype =</span> type,</span>
<span id="cb376-21"><a href="Chap-02-04-ggplot.html#cb376-21"></a>      <span class="dt">color =</span> type</span>
<span id="cb376-22"><a href="Chap-02-04-ggplot.html#cb376-22"></a>    )</span>
<span id="cb376-23"><a href="Chap-02-04-ggplot.html#cb376-23"></a>  ) <span class="op">+</span></span>
<span id="cb376-24"><a href="Chap-02-04-ggplot.html#cb376-24"></a><span class="st">  </span><span class="co"># declare that we want a scatter plot</span></span>
<span id="cb376-25"><a href="Chap-02-04-ggplot.html#cb376-25"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb376-26"><a href="Chap-02-04-ggplot.html#cb376-26"></a>    <span class="co"># set low opacity for each point</span></span>
<span id="cb376-27"><a href="Chap-02-04-ggplot.html#cb376-27"></a>    <span class="dt">alpha =</span> <span class="fl">0.1</span></span>
<span id="cb376-28"><a href="Chap-02-04-ggplot.html#cb376-28"></a>  ) <span class="op">+</span></span>
<span id="cb376-29"><a href="Chap-02-04-ggplot.html#cb376-29"></a><span class="st">  </span><span class="co"># add a linear model fit (for each group)</span></span>
<span id="cb376-30"><a href="Chap-02-04-ggplot.html#cb376-30"></a><span class="st">  </span><span class="kw">geom_smooth</span>(</span>
<span id="cb376-31"><a href="Chap-02-04-ggplot.html#cb376-31"></a>    <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb376-32"><a href="Chap-02-04-ggplot.html#cb376-32"></a>    <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span></span>
<span id="cb376-33"><a href="Chap-02-04-ggplot.html#cb376-33"></a>  ) <span class="op">+</span></span>
<span id="cb376-34"><a href="Chap-02-04-ggplot.html#cb376-34"></a><span class="st">  </span><span class="co"># change the default (normal) of x-axis to log-scale</span></span>
<span id="cb376-35"><a href="Chap-02-04-ggplot.html#cb376-35"></a><span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span></span>
<span id="cb376-36"><a href="Chap-02-04-ggplot.html#cb376-36"></a><span class="st">  </span><span class="co"># add dollar signs to y-axis labels</span></span>
<span id="cb376-37"><a href="Chap-02-04-ggplot.html#cb376-37"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span></span>
<span id="cb376-38"><a href="Chap-02-04-ggplot.html#cb376-38"></a><span class="st">  </span><span class="co"># change axis labels and plot title &amp; subtitle</span></span>
<span id="cb376-39"><a href="Chap-02-04-ggplot.html#cb376-39"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb376-40"><a href="Chap-02-04-ggplot.html#cb376-40"></a>    <span class="dt">x =</span> <span class="st">&#39;Total volume sold (on a log scale)&#39;</span>,</span>
<span id="cb376-41"><a href="Chap-02-04-ggplot.html#cb376-41"></a>    <span class="dt">y =</span> <span class="st">&#39;Average price&#39;</span>,</span>
<span id="cb376-42"><a href="Chap-02-04-ggplot.html#cb376-42"></a>    <span class="dt">title =</span> <span class="st">&quot;Avocado prices against amount sold&quot;</span>,</span>
<span id="cb376-43"><a href="Chap-02-04-ggplot.html#cb376-43"></a>    <span class="dt">subtitle =</span> <span class="st">&quot;With linear regression lines&quot;</span></span>
<span id="cb376-44"><a href="Chap-02-04-ggplot.html#cb376-44"></a>  )</span></code></pre></div>
<p><img src="I2DA_files/figure-html/unnamed-chunk-216-1.png" width="672" style="display: block; margin: auto;" /></p>
<!-- exercise 1 -->
<div class="exercises">
<p><strong>Exercise 6.1: Find the match</strong></p>
<p>Determine which graph was created with which code:</p>
<p>Code 1:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="Chap-02-04-ggplot.html#cb377-1"></a>code_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(avocado_data,</span>
<span id="cb377-2"><a href="Chap-02-04-ggplot.html#cb377-2"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb377-3"><a href="Chap-02-04-ggplot.html#cb377-3"></a>      <span class="dt">x =</span> average_price,</span>
<span id="cb377-4"><a href="Chap-02-04-ggplot.html#cb377-4"></a>      <span class="dt">y =</span> <span class="kw">log</span>(total_volume_sold), </span>
<span id="cb377-5"><a href="Chap-02-04-ggplot.html#cb377-5"></a>      <span class="dt">color =</span> type</span>
<span id="cb377-6"><a href="Chap-02-04-ggplot.html#cb377-6"></a>    )</span>
<span id="cb377-7"><a href="Chap-02-04-ggplot.html#cb377-7"></a>  ) <span class="op">+</span></span>
<span id="cb377-8"><a href="Chap-02-04-ggplot.html#cb377-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb377-9"><a href="Chap-02-04-ggplot.html#cb377-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p>Code 2:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="Chap-02-04-ggplot.html#cb378-1"></a>code_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(avocado_data,</span>
<span id="cb378-2"><a href="Chap-02-04-ggplot.html#cb378-2"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb378-3"><a href="Chap-02-04-ggplot.html#cb378-3"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb378-4"><a href="Chap-02-04-ggplot.html#cb378-4"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb378-5"><a href="Chap-02-04-ggplot.html#cb378-5"></a>      <span class="dt">color =</span> type</span>
<span id="cb378-6"><a href="Chap-02-04-ggplot.html#cb378-6"></a>    )</span>
<span id="cb378-7"><a href="Chap-02-04-ggplot.html#cb378-7"></a>  ) <span class="op">+</span></span>
<span id="cb378-8"><a href="Chap-02-04-ggplot.html#cb378-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb378-9"><a href="Chap-02-04-ggplot.html#cb378-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p>Code 3:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="Chap-02-04-ggplot.html#cb379-1"></a>code_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(avocado_data,</span>
<span id="cb379-2"><a href="Chap-02-04-ggplot.html#cb379-2"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb379-3"><a href="Chap-02-04-ggplot.html#cb379-3"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb379-4"><a href="Chap-02-04-ggplot.html#cb379-4"></a>      <span class="dt">y =</span> average_price</span>
<span id="cb379-5"><a href="Chap-02-04-ggplot.html#cb379-5"></a>    )</span>
<span id="cb379-6"><a href="Chap-02-04-ggplot.html#cb379-6"></a>  ) <span class="op">+</span></span>
<span id="cb379-7"><a href="Chap-02-04-ggplot.html#cb379-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb379-8"><a href="Chap-02-04-ggplot.html#cb379-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb379-9"><a href="Chap-02-04-ggplot.html#cb379-9"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb379-10"><a href="Chap-02-04-ggplot.html#cb379-10"></a>    <span class="dt">x =</span> <span class="st">&#39;Total volume sold (on a log scale)&#39;</span>,</span>
<span id="cb379-11"><a href="Chap-02-04-ggplot.html#cb379-11"></a>    <span class="dt">y =</span> <span class="st">&#39;Average price&#39;</span>,</span>
<span id="cb379-12"><a href="Chap-02-04-ggplot.html#cb379-12"></a>    <span class="dt">title =</span> <span class="st">&quot;Avocado prices against amount sold&quot;</span></span>
<span id="cb379-13"><a href="Chap-02-04-ggplot.html#cb379-13"></a>  )</span></code></pre></div>
<p>Code 4:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="Chap-02-04-ggplot.html#cb380-1"></a>code_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(avocado_data,</span>
<span id="cb380-2"><a href="Chap-02-04-ggplot.html#cb380-2"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(</span>
<span id="cb380-3"><a href="Chap-02-04-ggplot.html#cb380-3"></a>      <span class="dt">x =</span> <span class="kw">log</span>(total_volume_sold),</span>
<span id="cb380-4"><a href="Chap-02-04-ggplot.html#cb380-4"></a>      <span class="dt">y =</span> average_price,</span>
<span id="cb380-5"><a href="Chap-02-04-ggplot.html#cb380-5"></a>      <span class="dt">linetype =</span> type</span>
<span id="cb380-6"><a href="Chap-02-04-ggplot.html#cb380-6"></a>    )</span>
<span id="cb380-7"><a href="Chap-02-04-ggplot.html#cb380-7"></a>  ) <span class="op">+</span></span>
<span id="cb380-8"><a href="Chap-02-04-ggplot.html#cb380-8"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb380-9"><a href="Chap-02-04-ggplot.html#cb380-9"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb380-10"><a href="Chap-02-04-ggplot.html#cb380-10"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb380-11"><a href="Chap-02-04-ggplot.html#cb380-11"></a>    <span class="dt">x =</span> <span class="st">&#39;Total volume sold (on a log scale)&#39;</span>,</span>
<span id="cb380-12"><a href="Chap-02-04-ggplot.html#cb380-12"></a>    <span class="dt">y =</span> <span class="st">&#39;Average price&#39;</span>,</span>
<span id="cb380-13"><a href="Chap-02-04-ggplot.html#cb380-13"></a>    <span class="dt">title =</span> <span class="st">&quot;Avocado prices against amount sold&quot;</span></span>
<span id="cb380-14"><a href="Chap-02-04-ggplot.html#cb380-14"></a>  )</span></code></pre></div>
<p>Plot 1:
<img src="I2DA_files/figure-html/unnamed-chunk-222-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Plot 2:
<img src="I2DA_files/figure-html/unnamed-chunk-223-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Plot 3:
<img src="I2DA_files/figure-html/unnamed-chunk-224-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="collapsibleSolution">
<button class="trigger">
Solution
</button>
<div class="content">
<p>
Plot 1: Code 4
</p>
<p>
Plot 2: Code 1
</p>
<p>
Plot 3: Code 2
</p>
</div>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Wickham2010:A-Layered-Gramm">
<p>Wickham, Hadley. 2010. “A Layered Grammar of Graphics.” <em>Journal of Computational and Graphical Statistics</em> 19 (1): 3–28.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="29">
<li id="fn29"><p>If you run this code for yourself, the output is likely to look different from what is shown here. This is because this web-book uses a default theme for all of its plots. We will come back to customization with themes later.<a href="Chap-02-04-ggplot.html#fnref29" class="footnote-back">↩︎</a></p></li>
<li id="fn30"><p>Notice that, as soon as we add the linear regression line, it makes sense to use the logarithm of <code>total_volume_sold</code> because otherwise, the fit is quite ridiculous. The logarithm helps to spread out the large number of data points where <code>total_volume_sold</code> is very low, and to “bring back to the flock” the data points where <code>total_volume_sold</code> is outliery high. It can be quite useful to use such transformations, if they are well understood. It is controversial whether such transformations should precede statistical analyses, but that is not important right now.<a href="Chap-02-04-ggplot.html#fnref30" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chap-02-04-good-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Chap-02-04-geoms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
